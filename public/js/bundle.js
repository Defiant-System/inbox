class t{static fromString(e){return new t(e)}constructor(e){this.value=e}icaltype="binary";decodeValue(){return this._b64_decode(this.value)}setEncodedValue(e){this.value=this._b64_encode(e)}_b64_encode(e){let t,r,i,s,a,n,o,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,h=0,d="",p=[];if(!e)return e;do{t=e.charCodeAt(u++),r=e.charCodeAt(u++),i=e.charCodeAt(u++),l=t<<16|r<<8|i,s=l>>18&63,a=l>>12&63,n=l>>6&63,o=63&l,p[h++]=c.charAt(s)+c.charAt(a)+c.charAt(n)+c.charAt(o)}while(u<e.length);d=p.join("");let f=e.length%3;return(f?d.slice(0,f-3):d)+"===".slice(f||3)}_b64_decode(e){let t,r,i,s,a,n,o,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,h=0,d="",p=[];if(!e)return e;e+="";do{s=c.indexOf(e.charAt(u++)),a=c.indexOf(e.charAt(u++)),n=c.indexOf(e.charAt(u++)),o=c.indexOf(e.charAt(u++)),l=s<<18|a<<12|n<<6|o,t=l>>16&255,r=l>>8&255,i=255&l,p[h++]=64==n?String.fromCharCode(t):64==o?String.fromCharCode(t,r):String.fromCharCode(t,r,i)}while(u<e.length);return d=p.join(""),d}toString(){return this.value}}const e=/([PDWHMTS]{1,1})/,i=["weeks","days","hours","minutes","seconds","isNegative"];class r{static fromSeconds(e){return(new r).fromSeconds(e)}static isValueString(e){return"P"===e[0]||"P"===e[1]}static fromString(t){let i=0,s=Object.create(null),a=0;for(;-1!==(i=t.search(e));){let e=t[i],r=t.slice(0,Math.max(0,i));t=t.slice(i+1),a+=n(e,r,s)}if(a<2)throw new Error('invalid duration value: Not enough duration components in "'+t+'"');return new r(s)}static fromData(e){return new r(e)}constructor(e){this.wrappedJSObject=this,this.fromData(e)}weeks=0;days=0;hours=0;minutes=0;seconds=0;isNegative=!1;icalclass="icalduration";icaltype="duration";clone(){return r.fromData(this)}toSeconds(){let e=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-e:e}fromSeconds(e){let t=Math.abs(e);return this.isNegative=e<0,this.days=b(t/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,t-=86400*(this.days+7*this.weeks),this.hours=b(t/3600),t-=3600*this.hours,this.minutes=b(t/60),t-=60*this.minutes,this.seconds=t,this}fromData(e){for(let t of i)this[t]=e&&t in e?e[t]:0}reset(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0}compare(e){let t=this.toSeconds(),r=e.toSeconds();return(t>r)-(t<r)}normalize(){this.fromSeconds(this.toSeconds())}toString(){if(0==this.toSeconds())return"PT0S";{let e="";this.isNegative&&(e+="-"),e+="P";let t=!1;return this.weeks?this.days||this.hours||this.minutes||this.seconds?e+=7*this.weeks+this.days+"D":(e+=this.weeks+"W",t=!0):this.days&&(e+=this.days+"D"),t||(this.hours||this.minutes||this.seconds)&&(e+="T",this.hours&&(e+=this.hours+"H"),this.minutes&&(e+=this.minutes+"M"),this.seconds&&(e+=this.seconds+"S")),e}}toICALString(){return this.toString()}}function n(e,t,r){let i;switch(e){case"P":r.isNegative=!(!t||"-"!==t);break;case"D":i="days";break;case"W":i="weeks";break;case"H":i="hours";break;case"M":i="minutes";break;case"S":i="seconds";break;default:return 0}if(i){if(!t&&0!==t)throw new Error('invalid duration value: Missing number before "'+e+'"');let s=parseInt(t,10);if(y(s))throw new Error('invalid duration value: Invalid number "'+t+'" before "'+e+'"');r[i]=s}return 1}class s{static fromString(e,t){let i=e.split("/");if(2!==i.length)throw new Error('Invalid string value: "'+e+'" must contain a "/" char.');let n={start:a.fromDateTimeString(i[0],t)},o=i[1];return r.isValueString(o)?n.duration=r.fromString(o):n.end=a.fromDateTimeString(o,t),new s(n)}static fromData(e){return new s(e)}static fromJSON(e,t,i){function n(e,t){return i?a.fromString(e,t):a.fromDateTimeString(e,t)}return r.isValueString(e[1])?s.fromData({start:n(e[0],t),duration:r.fromString(e[1])}):s.fromData({start:n(e[0],t),end:n(e[1],t)})}constructor(e){if(this.wrappedJSObject=this,e&&"start"in e){if(e.start&&!(e.start instanceof a))throw new TypeError(".start must be an instance of ICAL.Time");this.start=e.start}if(e&&e.end&&e.duration)throw new Error("cannot accept both end and duration");if(e&&"end"in e){if(e.end&&!(e.end instanceof a))throw new TypeError(".end must be an instance of ICAL.Time");this.end=e.end}if(e&&"duration"in e){if(e.duration&&!(e.duration instanceof r))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=e.duration}}start=null;end=null;duration=null;icalclass="icalperiod";icaltype="period";clone(){return s.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})}getDuration(){return this.duration?this.duration:this.end.subtractDate(this.start)}getEnd(){if(this.end)return this.end;{let e=this.start.clone();return e.addDuration(this.duration),e}}compare(e){return e.compare(this.start)<0?1:e.compare(this.getEnd())>0?-1:0}toString(){return this.start+"/"+(this.end||this.duration)}toJSON(){return[this.start.toString(),(this.end||this.duration).toString()]}toICALString(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}}class a{static _dowCache={};static _wnCache={};static daysInMonth(e,t){let r=30;return e<1||e>12||(r=[0,31,28,31,30,31,30,31,31,30,31,30,31][e],2==e&&(r+=a.isLeapYear(t))),r}static isLeapYear(e){return e<=1752?e%4==0:e%4==0&&e%100!=0||e%400==0}static fromDayOfYear(e,t){let r=t,i=e,s=new a;s.auto_normalize=!1;let n=a.isLeapYear(r)?1:0;if(i<1)return r--,n=a.isLeapYear(r)?1:0,i+=a.daysInYearPassedMonth[n][12],a.fromDayOfYear(i,r);if(i>a.daysInYearPassedMonth[n][12])return n=a.isLeapYear(r)?1:0,i-=a.daysInYearPassedMonth[n][12],r++,a.fromDayOfYear(i,r);s.year=r,s.isDate=!0;for(let e=11;e>=0;e--)if(i>a.daysInYearPassedMonth[n][e]){s.month=e+1,s.day=i-a.daysInYearPassedMonth[n][e];break}return s.auto_normalize=!0,s}static fromStringv2(e){return new a({year:parseInt(e.slice(0,4),10),month:parseInt(e.slice(5,7),10),day:parseInt(e.slice(8,10),10),isDate:!0})}static fromDateString(e){return new a({year:_(e.slice(0,4)),month:_(e.slice(5,7)),day:_(e.slice(8,10)),isDate:!0})}static fromDateTimeString(e,t){if(e.length<19)throw new Error('invalid date-time value: "'+e+'"');let r,i;"Z"===e.slice(-1)?r=m.utcTimezone:t&&(i=t.getParameter("tzid"),t.parent&&("standard"===t.parent.name||"daylight"===t.parent.name?r=m.localTimezone:i&&(r=t.parent.getTimeZoneByID(i))));const s={year:_(e.slice(0,4)),month:_(e.slice(5,7)),day:_(e.slice(8,10)),hour:_(e.slice(11,13)),minute:_(e.slice(14,16)),second:_(e.slice(17,19))};return i&&!r&&(s.timezone=i),new a(s,r)}static fromString(e,t){return e.length>10?a.fromDateTimeString(e,t):a.fromDateString(e)}static fromJSDate(e,t){return(new a).fromJSDate(e,t)}static fromData=function(e,t){return(new a).fromData(e,t)};static now(){return a.fromJSDate(new Date,!1)}static weekOneStarts(e,t){let r=a.fromData({year:e,month:1,day:1,isDate:!0}),i=r.dayOfWeek(),s=t||a.DEFAULT_WEEK_START;return i>a.THURSDAY&&(r.day+=7),s>a.THURSDAY&&(r.day-=7),r.day-=i-s,r}static getDominicalLetter(e){let t="GFEDCBA",r=(e+(e/4|0)+(e/400|0)-(e/100|0)-1)%7;return a.isLeapYear(e)?t[(r+6)%7]+t[r]:t[r]}static#e=null;static get epochTime(){return this.#e||(this.#e=a.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"})),this.#e}static _cmp_attr(e,t,r){return e[r]>t[r]?1:e[r]<t[r]?-1:0}static daysInYearPassedMonth=[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]];static SUNDAY=1;static MONDAY=2;static TUESDAY=3;static WEDNESDAY=4;static THURSDAY=5;static FRIDAY=6;static SATURDAY=7;static DEFAULT_WEEK_START=2;constructor(e,t){this.wrappedJSObject=this,this._time=Object.create(null),this._time.year=0,this._time.month=1,this._time.day=1,this._time.hour=0,this._time.minute=0,this._time.second=0,this._time.isDate=!1,this.fromData(e,t)}icalclass="icaltime";_cachedUnixTime=null;get icaltype(){return this.isDate?"date":"date-time"}zone=null;_pendingNormalization=!1;get year(){return this._getTimeAttr("year")}set year(e){this._setTimeAttr("year",e)}get month(){return this._getTimeAttr("month")}set month(e){this._setTimeAttr("month",e)}get day(){return this._getTimeAttr("day")}set day(e){this._setTimeAttr("day",e)}get hour(){return this._getTimeAttr("hour")}set hour(e){this._setTimeAttr("hour",e)}get minute(){return this._getTimeAttr("minute")}set minute(e){this._setTimeAttr("minute",e)}get second(){return this._getTimeAttr("second")}set second(e){this._setTimeAttr("second",e)}get isDate(){return this._getTimeAttr("isDate")}set isDate(e){this._setTimeAttr("isDate",e)}_getTimeAttr(e){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[e]}_setTimeAttr(e,t){"isDate"===e&&t&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[e]=t}clone(){return new a(this._time,this.zone)}reset(){this.fromData(a.epochTime),this.zone=m.utcTimezone}resetTo(e,t,r,i,s,a,n){this.fromData({year:e,month:t,day:r,hour:i,minute:s,second:a,zone:n})}fromJSDate(e,t){return e?t?(this.zone=m.utcTimezone,this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()):(this.zone=m.localTimezone,this.year=e.getFullYear(),this.month=e.getMonth()+1,this.day=e.getDate(),this.hour=e.getHours(),this.minute=e.getMinutes(),this.second=e.getSeconds()):this.reset(),this._cachedUnixTime=null,this}fromData(e,t){if(e)for(let[t,r]of Object.entries(e))"icaltype"!==t&&(this[t]=r);if(t&&(this.zone=t),e&&!("isDate"in e)?this.isDate=!("hour"in e):e&&"isDate"in e&&(this.isDate=e.isDate),e&&"timezone"in e){let t=p.get(e.timezone);this.zone=t||m.localTimezone}return e&&"zone"in e&&(this.zone=e.zone),this.zone||(this.zone=m.localTimezone),this._cachedUnixTime=null,this}dayOfWeek(e){let t=e||a.SUNDAY,r=(this.year<<12)+(this.month<<8)+(this.day<<3)+t;if(r in a._dowCache)return a._dowCache[r];let i=this.day,s=this.month+(this.month<3?12:0),n=this.year-(this.month<3?1:0),o=i+n+b(26*(s+1)/10)+b(n/4);return o+=6*b(n/100)+b(n/400),o=(o+7-t)%7+1,a._dowCache[r]=o,o}dayOfYear(){let e=a.isLeapYear(this.year)?1:0;return a.daysInYearPassedMonth[e][this.month-1]+this.day}startOfWeek(e){let t=e||a.SUNDAY,r=this.clone();return r.day-=(this.dayOfWeek()+7-t)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r}endOfWeek(e){let t=e||a.SUNDAY,r=this.clone();return r.day+=(7-this.dayOfWeek()+t-a.SUNDAY)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r}startOfMonth(){let e=this.clone();return e.day=1,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e}endOfMonth(){let e=this.clone();return e.day=a.daysInMonth(e.month,e.year),e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e}startOfYear(){let e=this.clone();return e.day=1,e.month=1,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e}endOfYear(){let e=this.clone();return e.day=31,e.month=12,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e}startDoyWeek(e){let t=e||a.SUNDAY,r=this.dayOfWeek()-t;return r<0&&(r+=7),this.dayOfYear()-r}getDominicalLetter(){return a.getDominicalLetter(this.year)}nthWeekDay(e,t){let r,i=a.daysInMonth(this.month,this.year),s=t,n=0,o=this.clone();if(s>=0){o.day=1,0!=s&&s--,n=o.day;let t=e-o.dayOfWeek();t<0&&(t+=7),n+=t,n-=e,r=e}else{o.day=i,s++,r=o.dayOfWeek()-e,r<0&&(r+=7),r=i-r}return r+=7*s,n+r}isNthWeekDay(e,t){let r=this.dayOfWeek();return 0===t&&r===e||this.nthWeekDay(e,t)===this.day}weekNumber(e){let t,r=(this.year<<12)+(this.month<<8)+(this.day<<3)+e;if(r in a._wnCache)return a._wnCache[r];let i=this.clone();i.isDate=!0;let s=this.year;12==i.month&&i.day>25?(t=a.weekOneStarts(s+1,e),i.compare(t)<0?t=a.weekOneStarts(s,e):s++):(t=a.weekOneStarts(s,e),i.compare(t)<0&&(t=a.weekOneStarts(--s,e)));let n=b(i.subtractDate(t).toSeconds()/86400/7)+1;return a._wnCache[r]=n,n}addDuration(e){let t=e.isNegative?-1:1,r=this.second,i=this.minute,s=this.hour,a=this.day;r+=t*e.seconds,i+=t*e.minutes,s+=t*e.hours,a+=t*e.days,a+=7*t*e.weeks,this.second=r,this.minute=i,this.hour=s,this.day=a,this._cachedUnixTime=null}subtractDate(e){let t=this.toUnixTime()+this.utcOffset(),i=e.toUnixTime()+e.utcOffset();return r.fromSeconds(t-i)}subtractDateTz(e){let t=this.toUnixTime(),i=e.toUnixTime();return r.fromSeconds(t-i)}compare(e){if(e instanceof s)return-1*e.compare(this);{let t=this.toUnixTime(),r=e.toUnixTime();return t>r?1:r>t?-1:0}}compareDateOnlyTz(e,t){let r=this.convertToZone(t),i=e.convertToZone(t),s=0;return 0!=(s=a._cmp_attr(r,i,"year"))||0!=(s=a._cmp_attr(r,i,"month"))||(s=a._cmp_attr(r,i,"day")),s}convertToZone(e){let t=this.clone(),r=this.zone.tzid==e.tzid;return this.isDate||r||m.convert_time(t,this.zone,e),t.zone=e,t}utcOffset(){return this.zone==m.localTimezone||this.zone==m.utcTimezone?0:this.zone.utcOffset(this)}toICALString(){let e=this.toString();return e.length>10?ct.icalendar.value["date-time"].toICAL(e):ct.icalendar.value.date.toICAL(e)}toString(){let e=this.year+"-"+O(this.month)+"-"+O(this.day);return this.isDate||(e+="T"+O(this.hour)+":"+O(this.minute)+":"+O(this.second),this.zone===m.utcTimezone&&(e+="Z")),e}toJSDate(){return this.zone==m.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(1e3*this.toUnixTime())}_normalize(){return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this}adjust(e,t,r,i,s){let n,o,l,c,u,h,d,p=0,f=0,m=s||this._time;if(m.isDate||(l=m.second+i,m.second=l%60,n=b(l/60),m.second<0&&(m.second+=60,n--),c=m.minute+r+n,m.minute=c%60,o=b(c/60),m.minute<0&&(m.minute+=60,o--),u=m.hour+t+o,m.hour=u%24,p=b(u/24),m.hour<0&&(m.hour+=24,p--)),m.month>12?f=b((m.month-1)/12):m.month<1&&(f=b(m.month/12)-1),m.year+=f,m.month-=12*f,h=m.day+e+p,h>0)for(;d=a.daysInMonth(m.month,m.year),!(h<=d);)m.month++,m.month>12&&(m.year++,m.month=1),h-=d;else for(;h<=0;)1==m.month?(m.year--,m.month=12):m.month--,h+=a.daysInMonth(m.month,m.year);return m.day=h,this._cachedUnixTime=null,this}fromUnixTime(e){this.zone=m.utcTimezone;let t=new Date(1e3*e);this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this._time.isDate?(this.hour=0,this.minute=0,this.second=0):(this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()),this._cachedUnixTime=null}toUnixTime(){if(null!==this._cachedUnixTime)return this._cachedUnixTime;let e=this.utcOffset(),t=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-e);return this._cachedUnixTime=t/1e3,this._cachedUnixTime}toJSON(){let e,t=["year","month","day","hour","minute","second","isDate"],r=Object.create(null),i=0,s=t.length;for(;i<s;i++)e=t[i],r[e]=this[e];return this.zone&&(r.timezone=this.zone.tzid),r}}const o=/[^ \t]/,l=":",h={"^'":'"',"^n":"\n","^^":"^"};function u(e){let t={},r=t.component=[];if(t.stack=[r],u._eachLine(e,(function(e,r){u._handleContentLine(r,t)})),t.stack.length>1)throw new c("invalid ical body. component began but did not end");return t=null,1==r.length?r[0]:r}u.property=function(e,t){let r={component:[[],[]],designSet:t||ct.defaultSet};return u._handleContentLine(e,r),r.component[1][0]},u.component=function(e){return u(e)};class c extends Error{name=this.constructor.name}u.ParserError=c,u._handleContentLine=function(e,t){let r,i,s,a,n,o,h=e.indexOf(l),d=e.indexOf(";"),p={};if(-1!==d&&-1!==h&&d>h&&(d=-1),-1!==d){if(s=e.slice(0,Math.max(0,d)).toLowerCase(),n=u._parseParameters(e.slice(Math.max(0,d)),0,t.designSet),-1==n[2])throw new c("Invalid parameters in '"+e+"'");let o;if(p=n[0],o="string"==typeof n[1]?n[1].length:n[1].reduce(((e,t)=>e+t.length),0),r=o+n[2]+d,-1===(i=e.slice(Math.max(0,r)).indexOf(l)))throw new c("Missing parameter value in '"+e+"'");a=e.slice(Math.max(0,r+i+1))}else{if(-1===h)throw new c('invalid line (no token ";" or ":") "'+e+'"');if(s=e.slice(0,Math.max(0,h)).toLowerCase(),a=e.slice(Math.max(0,h+1)),"begin"===s){let e=[a.toLowerCase(),[],[]];return 1===t.stack.length?t.component.push(e):t.component[2].push(e),t.stack.push(t.component),t.component=e,void(t.designSet||(t.designSet=ct.getDesignSet(t.component[0])))}if("end"===s)return void(t.component=t.stack.pop())}let f,m,y,g,b=!1,_=!1;t.designSet.propertyGroups&&-1!==s.indexOf(".")?(m=s.split("."),p.group=m[0],y=m[1]):y=s,y in t.designSet.property&&(f=t.designSet.property[y],"multiValue"in f&&(b=f.multiValue),"structuredValue"in f&&(_=f.structuredValue),a&&"detectType"in f&&(o=f.detectType(a))),o||(o="value"in p?p.value.toLowerCase():f?f.defaultType:"unknown"),delete p.value,b&&_?(a=u._parseMultiValue(a,_,o,[],b,t.designSet,_),g=[y,p,o,a]):b?(g=[y,p,o],u._parseMultiValue(a,b,o,g,null,t.designSet,!1)):_?(a=u._parseMultiValue(a,_,o,[],null,t.designSet,_),g=[y,p,o,a]):(a=u._parseValue(a,o,t.designSet,!1),g=[y,p,o,a]),"vcard"!==t.component[0]||0!==t.component[1].length||"version"===s&&"4.0"===a||(t.designSet=ct.getDesignSet("vcard3")),t.component[1].push(g)},u._parseValue=function(e,t,r,i){return t in r.value&&"fromICAL"in r.value[t]?r.value[t].fromICAL(e,i):e},u._parseParameters=function(e,t,r){let i,s,a,n,o,h,d=t,p=0,f={},m=-1;for(;!1!==p&&-1!==(p=e.indexOf("=",p+1));){if(i=e.slice(d+1,p),0==i.length)throw new c("Empty parameter name in '"+e+"'");if(s=i.toLowerCase(),h=!1,o=!1,n=s in r.param&&r.param[s].valueType?r.param[s].valueType:"text",s in r.param&&(o=r.param[s].multiValue,r.param[s].multiValueSeparateDQuote&&(h=u._rfc6868Escape('"'+o+'"'))),'"'===e[p+1]){if(m=p+2,p=e.indexOf('"',m),o&&-1!=p){let t=!0;for(;t;)e[p+1]==o&&'"'==e[p+2]?p=e.indexOf('"',p+3):t=!1}if(-1===p)throw new c('invalid line (no matching double quote) "'+e+'"');a=e.slice(m,p),d=e.indexOf(";",p);let t=e.indexOf(l,p);(-1===d||-1!==t&&d>t)&&(p=!1)}else{m=p+1;let t=e.indexOf(";",m),r=e.indexOf(l,m);-1!==r&&t>r?(t=r,p=!1):-1===t?(t=-1===r?e.length:r,p=!1):(d=t,p=t),a=e.slice(m,t)}const t=a.length;if(a=u._rfc6868Escape(a),m+=t-a.length,o){let e=h||o;a=u._parseMultiValue(a,e,n,[],null,r)}else a=u._parseValue(a,n,r);o&&s in f?Array.isArray(f[s])?f[s].push(a):f[s]=[f[s],a]:f[s]=a}return[f,a,m]},u._rfc6868Escape=function(e){return e.replace(/\^['n^]/g,(function(e){return h[e]}))},u._parseMultiValue=function(e,t,r,i,s,a,n){let o,l=0,c=0;if(0===t.length)return e;for(;-1!==(l=D(e,t,c));)o=e.slice(c,l),o=s?u._parseMultiValue(o,s,r,[],null,a,n):u._parseValue(o,r,a,n),i.push(o),c=l+t.length;return o=e.slice(c),o=s?u._parseMultiValue(o,s,r,[],null,a,n):u._parseValue(o,r,a,n),i.push(o),1==i.length?i[0]:i},u._eachLine=function(e,t){let r,i,s,a=e.length,n=e.search(o),l=n;do{l=e.indexOf("\n",n)+1,s=l>1&&"\r"===e[l-2]?2:1,0===l&&(l=a,s=0),i=e[n]," "===i||"\t"===i?r+=e.slice(n+1,l-s):(r&&t(null,r),r=e.slice(n,l-s)),n=l}while(l!==a);r=r.trim(),r.length&&t(null,r)};const d=["tzid","location","tznames","latitude","longitude"];class m{static _compare_change_fn(e,t){return e.year<t.year?-1:e.year>t.year?1:e.month<t.month?-1:e.month>t.month?1:e.day<t.day?-1:e.day>t.day?1:e.hour<t.hour?-1:e.hour>t.hour?1:e.minute<t.minute?-1:e.minute>t.minute?1:e.second<t.second?-1:e.second>t.second?1:0}static convert_time(e,t,r){if(e.isDate||t.tzid==r.tzid||t==m.localTimezone||r==m.localTimezone)return e.zone=r,e;let i=t.utcOffset(e);return e.adjust(0,0,0,-i),i=r.utcOffset(e),e.adjust(0,0,0,i),null}static fromData(e){return(new m).fromData(e)}static#t=null;static get utcTimezone(){return this.#t||(this.#t=m.fromData({tzid:"UTC"})),this.#t}static#r=null;static get localTimezone(){return this.#r||(this.#r=m.fromData({tzid:"floating"})),this.#r}static adjust_change(e,t,r,i,s){return a.prototype.adjust.call(e,t,r,i,s,e)}static _minimumExpansionYear=-1;static EXTRA_COVERAGE=5;constructor(e){this.wrappedJSObject=this,this.fromData(e)}tzid="";location="";tznames="";latitude=0;longitude=0;component=null;expandedUntilYear=0;icalclass="icaltimezone";fromData(e){if(this.expandedUntilYear=0,this.changes=[],e instanceof _t)this.component=e;else{if(e&&"component"in e)if("string"==typeof e.component){let t=u(e.component);this.component=new _t(t)}else e.component instanceof _t?this.component=e.component:this.component=null;for(let t of d)e&&t in e&&(this[t]=e[t])}return this.component instanceof _t&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this}utcOffset(e){if(this==m.utcTimezone||this==m.localTimezone)return 0;if(this._ensureCoverage(e.year),!this.changes.length)return 0;let t={year:e.year,month:e.month,day:e.day,hour:e.hour,minute:e.minute,second:e.second},r=this._findNearbyChange(t),i=-1,s=1;for(;;){let e=Y(this.changes[r],!0);if(e.utcOffset<e.prevUtcOffset?m.adjust_change(e,0,0,0,e.utcOffset):m.adjust_change(e,0,0,0,e.prevUtcOffset),m._compare_change_fn(t,e)>=0?i=r:s=-1,-1==s&&-1!=i)break;if(r+=s,r<0)return 0;if(r>=this.changes.length)break}let a=this.changes[i];if(a.utcOffset-a.prevUtcOffset<0&&i>0){let e=Y(a,!0);if(m.adjust_change(e,0,0,0,e.prevUtcOffset),m._compare_change_fn(t,e)<0){let e=this.changes[i-1],t=!1;a.is_daylight!=t&&e.is_daylight==t&&(a=e)}}return a.utcOffset}_findNearbyChange(e){let t=T(this.changes,e,m._compare_change_fn);return t>=this.changes.length?this.changes.length-1:t}_ensureCoverage(e){if(-1==m._minimumExpansionYear){let e=a.now();m._minimumExpansionYear=e.year}let t=e;if(t<m._minimumExpansionYear&&(t=m._minimumExpansionYear),t+=m.EXTRA_COVERAGE,!this.changes.length||this.expandedUntilYear<e){let e=this.component.getAllSubcomponents(),r=e.length,i=0;for(;i<r;i++)this._expandComponent(e[i],t,this.changes);this.changes.sort(m._compare_change_fn),this.expandedUntilYear=t}}_expandComponent(e,t,r){if(!e.hasProperty("dtstart")||!e.hasProperty("tzoffsetto")||!e.hasProperty("tzoffsetfrom"))return null;let i,s=e.getFirstProperty("dtstart").getFirstValue();function a(e){return e.factor*(3600*e.hours+60*e.minutes)}function n(){let t={};return t.is_daylight="daylight"==e.name,t.utcOffset=a(e.getFirstProperty("tzoffsetto").getFirstValue()),t.prevUtcOffset=a(e.getFirstProperty("tzoffsetfrom").getFirstValue()),t}if(e.hasProperty("rrule")||e.hasProperty("rdate")){let a=e.getAllProperties("rdate");for(let e of a){let t=e.getFirstValue();i=n(),i.year=t.year,i.month=t.month,i.day=t.day,t.isDate?(i.hour=s.hour,i.minute=s.minute,i.second=s.second,s.zone!=m.utcTimezone&&m.adjust_change(i,0,0,0,-i.prevUtcOffset)):(i.hour=t.hour,i.minute=t.minute,i.second=t.second,t.zone!=m.utcTimezone&&m.adjust_change(i,0,0,0,-i.prevUtcOffset)),r.push(i)}let o=e.getFirstProperty("rrule");if(o){o=o.getFirstValue(),i=n(),o.until&&o.until.zone==m.utcTimezone&&(o.until.adjust(0,0,0,i.prevUtcOffset),o.until.zone=m.localTimezone);let e,a=o.iterator(s);for(;(e=a.next())&&(i=n(),!(e.year>t)&&e);)i.year=e.year,i.month=e.month,i.day=e.day,i.hour=e.hour,i.minute=e.minute,i.second=e.second,i.isDate=e.isDate,m.adjust_change(i,0,0,0,-i.prevUtcOffset),r.push(i)}}else i=n(),i.year=s.year,i.month=s.month,i.day=s.day,i.hour=s.hour,i.minute=s.minute,i.second=s.second,m.adjust_change(i,0,0,0,-i.prevUtcOffset),r.push(i);return r}toString(){return this.tznames?this.tznames:this.tzid}}let f=null;const p={get count(){return null===f?0:Object.keys(f).length},reset:function(){f=Object.create(null);let e=m.utcTimezone;f.Z=e,f.UTC=e,f.GMT=e},_hard_reset:function(){f=null},has:function(e){return null!==f&&!!f[e]},get:function(e){return null===f&&this.reset(),f[e]},register:function(e,t){if(null===f&&this.reset(),"string"==typeof e&&t instanceof m&&([e,t]=[t,e]),t||(e instanceof m?t=e.tzid:"vtimezone"===e.name&&(t=(e=new m(e)).tzid)),!t)throw new TypeError("Neither a timezone nor a name was passed");if(!(e instanceof m))throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component");f[t]=e},remove:function(e){return null===f?null:delete f[e]}};function y(e){return"number"==typeof e&&isNaN(e)}function _(e){let t=parseInt(e,10);if(y(t))throw new Error('Could not extract integer from "'+e+'"');return t}function g(e,t){if(void 0!==e)return e instanceof t?e:new t(e)}function D(e,t,r){for(;-1!==(r=e.indexOf(t,r));){if(!(r>0&&"\\"===e[r-1]))return r;r+=1}return-1}function T(e,t,r){if(!e.length)return 0;let i,s,a=0,n=e.length-1;for(;a<=n;)if(i=a+Math.floor((n-a)/2),s=r(t,e[i]),s<0)n=i-1;else{if(!(s>0))break;a=i+1}return s<0?i:s>0?i+1:i}function Y(e,t){if(e&&"object"==typeof e){if(e instanceof Date)return new Date(e.getTime());if("clone"in e)return e.clone();if(Array.isArray(e)){let r=[];for(let i=0;i<e.length;i++)r.push(t?Y(e[i],!0):e[i]);return r}{let r={};for(let[i,s]of Object.entries(e))r[i]=t?Y(s,!0):s;return r}}return e}function A(e){let t="",r=e||"",i=0,s=0;for(;r.length;){let e=r.codePointAt(i);e<128?++s:s+=e<2048?2:e<65536?3:4,s<Yt.foldLength+1?i+=e>65535?2:1:(t+=Yt.newLineChar+" "+r.slice(0,Math.max(0,i)),r=r.slice(Math.max(0,i)),i=s=0)}return t.slice(Yt.newLineChar.length+1)}function O(e){switch("string"!=typeof e&&("number"==typeof e&&(e=parseInt(e)),e=String(e)),e.length){case 0:return"00";case 1:return"0"+e;default:return e}}function b(e){return e<0?Math.ceil(e):Math.floor(e)}function S(e,t){for(let r in e){let i=Object.getOwnPropertyDescriptor(e,r);i&&!Object.getOwnPropertyDescriptor(t,r)&&Object.defineProperty(t,r,i)}return t}var E=Object.freeze({__proto__:null,binsearchInsert:T,clone:Y,extend:S,foldline:A,formatClassType:g,isStrictlyNaN:y,pad2:O,strictParseInt:_,trunc:b,unescapedIndexOf:D,updateTimezones:function(e){let t,r,i,s,a;if(!e||"vcalendar"!==e.name)return e;for(t=e.getAllSubcomponents(),r=[],i={},a=0;a<t.length;a++)if("vtimezone"===t[a].name){i[t[a].getFirstProperty("tzid").getFirstValue()]=t[a]}else r=r.concat(t[a].getAllProperties());for(s={},a=0;a<r.length;a++){let e=r[a].getParameter("tzid");e&&(s[e]=!0)}for(let[t,r]of Object.entries(i))s[t]||e.removeSubcomponent(r);for(let t of Object.keys(s))!i[t]&&p.has(t)&&e.addSubcomponent(p.get(t).component);return e}});class w{static fromString(e){let t={};return t.factor="+"===e[0]?1:-1,t.hours=_(e.slice(1,3)),t.minutes=_(e.slice(4,6)),new w(t)}static fromSeconds(e){let t=new w;return t.fromSeconds(e),t}constructor(e){this.fromData(e)}hours=0;minutes=0;factor=1;icaltype="utc-offset";clone(){return w.fromSeconds(this.toSeconds())}fromData(e){if(e)for(let[t,r]of Object.entries(e))this[t]=r;this._normalize()}fromSeconds(e){let t=Math.abs(e);return this.factor=e<0?-1:1,this.hours=b(t/3600),t-=3600*this.hours,this.minutes=b(t/60),this}toSeconds(){return this.factor*(60*this.minutes+3600*this.hours)}compare(e){let t=this.toSeconds(),r=e.toSeconds();return(t>r)-(r>t)}_normalize(){let e=this.toSeconds(),t=this.factor;for(;e<-43200;)e+=97200;for(;e>50400;)e-=97200;this.fromSeconds(e),0==e&&(this.factor=t)}toICALString(){return ct.icalendar.value["utc-offset"].toICAL(this.toString())}toString(){return(1==this.factor?"+":"-")+O(this.hours)+":"+O(this.minutes)}}class C extends a{static fromDateAndOrTimeString(e,t){function r(e,t,r){return e?_(e.slice(t,t+r)):null}let i=e.split("T"),s=i[0],a=i[1],n=a?ct.vcard.value.time._splitZone(a):[],o=n[0],l=n[1],c=s?s.length:0,u=l?l.length:0,h=s&&"-"==s[0]&&"-"==s[1],d=l&&"-"==l[0],p={year:h?null:r(s,0,4),month:!h||4!=c&&7!=c?7==c||10==c?r(s,5,2):null:r(s,2,2),day:5==c?r(s,3,2):7==c&&h?r(s,5,2):10==c?r(s,8,2):null,hour:d?null:r(l,0,2),minute:d&&3==u?r(l,1,2):u>4?r(l,d?1:3,2):null,second:4==u?r(l,2,2):6==u?r(l,4,2):8==u?r(l,6,2):null};return o="Z"==o?m.utcTimezone:o&&":"==o[3]?w.fromString(o):null,new C(p,o,t)}constructor(e,t,r){super(e,t),this.icaltype=r||"date-and-or-time"}icalclass="vcardtime";icaltype="date-and-or-time";clone(){return new C(this._time,this.zone,this.icaltype)}_normalize(){return this}utcOffset(){return this.zone instanceof w?this.zone.toSeconds():a.prototype.utcOffset.apply(this,arguments)}toICALString(){return ct.vcard.value[this.icaltype].toICAL(this.toString())}toString(){let e,t=this.year,r=this.month,i=this.day,s=this.hour,a=this.minute,n=this.second,o=null!==r,l=null!==i,c=null!==s,u=null!==a,h=null!==n,d=(null!==t?O(t)+(o||l?"-":""):o||l?"--":"")+(o?O(r):"")+(l?"-"+O(i):""),p=(c?O(s):"-")+(c&&u?":":"")+(u?O(a):"")+(c||u?"":"-")+(u&&h?":":"")+(h?O(n):"");if(this.zone===m.utcTimezone)e="Z";else if(this.zone instanceof w)e=this.zone.toString();else if(this.zone===m.localTimezone)e="";else if(this.zone instanceof m){e=w.fromSeconds(this.zone.utcOffset(this)).toString()}else e="";switch(this.icaltype){case"time":return p+e;case"date-and-or-time":case"date-time":return d+("--"==p?"":"T"+p+e);case"date":return d}return null}}class x{static _indexMap={BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8};static _expandMap={SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]};static UNKNOWN=0;static CONTRACT=1;static EXPAND=2;static ILLEGAL=3;constructor(e){this.fromData(e)}completed=!1;rule=null;dtstart=null;last=null;occurrence_number=0;by_indices=null;initialized=!1;by_data=null;days=null;days_index=0;fromData(e){if(this.rule=g(e.rule,L),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=g(e.dtstart,a),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");if(e.by_data?this.by_data=e.by_data:this.by_data=Y(this.rule.parts,!0),e.occurrence_number&&(this.occurrence_number=e.occurrence_number),this.days=e.days||[],e.last&&(this.last=g(e.last,a)),this.by_indices=e.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=e.initialized||!1,!this.initialized)try{this.init()}catch(e){if(!(e instanceof N))throw e;this.completed=!0}}init(){this.initialized=!0,this.last=this.dtstart.clone();let e=this.by_data;if("BYDAY"in e&&this.sort_byday_rules(e.BYDAY),"BYYEARDAY"in e&&("BYMONTH"in e||"BYWEEKNO"in e||"BYMONTHDAY"in e))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in e&&"BYMONTHDAY"in e)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if("MONTHLY"==this.rule.freq&&("BYYEARDAY"in e||"BYWEEKNO"in e))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if("WEEKLY"==this.rule.freq&&("BYYEARDAY"in e||"BYMONTHDAY"in e))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if("YEARLY"!=this.rule.freq&&"BYYEARDAY"in e)throw new Error("BYYEARDAY may only appear in YEARLY rules");if(this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour),this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day),this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),"WEEKLY"==this.rule.freq)if("BYDAY"in e){let[,t]=this.ruleDayOfWeek(e.BYDAY[0],this.rule.wkst),r=t-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<t&&r>=0||r<0)&&(this.last.day+=r)}else{let t=L.numericDayToIcalDay(this.dtstart.dayOfWeek());e.BYDAY=[t]}if("YEARLY"==this.rule.freq){const e=this.rule.until?this.rule.until.year:2e4;for(;this.last.year<=e&&(this.expand_year_days(this.last.year),!(this.days.length>0));)this.increment_year(this.rule.interval);if(0==this.days.length)throw new N;if(!(this._nextByYearDay()||this.next_year()||this.next_year()||this.next_year()))throw new N}if("MONTHLY"==this.rule.freq)if(this.has_by_data("BYDAY")){let e=null,t=this.last.clone(),r=a.daysInMonth(this.last.month,this.last.year);for(let i of this.by_data.BYDAY){this.last=t.clone();let[s,n]=this.ruleDayOfWeek(i),o=this.last.nthWeekDay(n,s);if(s>=6||s<=-6)throw new Error("Malformed values in BYDAY part");if(o>r||o<=0){if(e&&e.month==t.month)continue;for(;o>r||o<=0;)this.increment_month(),r=a.daysInMonth(this.last.month,this.last.year),o=this.last.nthWeekDay(n,s)}this.last.day=o,(!e||this.last.compare(e)<0)&&(e=this.last.clone())}if(this.last=e.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>r||0==this.last.day)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")){this.last.day=1;let e=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY).filter((e=>e>=this.last.day));if(e.length)this.last.day=e[0],this.by_data.BYMONTHDAY=e;else if(!this.next_month()&&!this.next_month()&&!this.next_month())throw new N}}next(e=!1){let t,r=this.last?this.last.clone():null;if((this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)&&(this.completed=!0),this.completed)return null;if(0==this.occurrence_number&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;let i=0;do{switch(t=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":if(t=this.next_month(),t)i=0;else if(336==++i)return this.completed=!0,null;break;case"YEARLY":if(t=this.next_year(),t)i=0;else if(28==++i)return this.completed=!0,null;break;default:return null}}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!t);if(0==this.last.compare(r)){if(e)throw new Error("Same occurrence found twice, protecting you from death by recursion");this.next(!0)}return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)}next_second(){return this.next_generic("BYSECOND","SECONDLY","second","minute")}increment_second(e){return this.increment_generic(e,"second",60,"minute")}next_minute(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")}increment_minute(e){return this.increment_generic(e,"minute",60,"hour")}next_hour(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")}increment_hour(e){this.increment_generic(e,"hour",24,"monthday")}next_day(){let e="DAILY"==this.rule.freq;return 0==this.next_hour()||(e?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0}next_week(){let e=0;if(0==this.next_weekday_by_week())return e;if(this.has_by_data("BYWEEKNO")){this.by_indices.BYWEEKNO++,this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,e=1),this.last.month=1,this.last.day=1;let t=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*t,e&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return e}normalizeByMonthDayRules(e,t,r){let i,s=a.daysInMonth(t,e),n=[],o=0,l=r.length;for(;o<l;o++){if(i=parseInt(r[o],10),isNaN(i))throw new Error("Invalid BYMONTHDAY value");if(!(Math.abs(i)>s)){if(i<0)i=s+(i+1);else if(0===i)continue;-1===n.indexOf(i)&&n.push(i)}}return n.sort((function(e,t){return e-t}))}_byDayAndMonthDay(e){let t,r,i,s,n=this.by_data.BYDAY,o=0,l=n.length,c=0,u=this,h=this.last.day;function d(){for(s=a.daysInMonth(u.last.month,u.last.year),t=u.normalizeByMonthDayRules(u.last.year,u.last.month,u.by_data.BYMONTHDAY),i=t.length;t[o]<=h&&(!e||t[o]!=h)&&o<i-1;)o++}function p(){h=0,u.increment_month(),o=0,d()}d(),e&&(h-=1);let f=48;for(;!c&&f;){if(f--,r=h+1,r>s){p();continue}let e=t[o++];if(e>=r){h=e;for(let e=0;e<l;e++){let t=this.ruleDayOfWeek(n[e]),r=t[0],i=t[1];if(this.last.day=h,this.last.isNthWeekDay(i,r)){c=1;break}}c||o!==i||p()}else p()}if(f<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return c}next_month(){let e=1;if(0==this.next_hour())return e;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))e=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){let t,r=a.daysInMonth(this.last.month,this.last.year),i=0,s=0;if(this.has_by_data("BYSETPOS")){let e=this.last.day;for(let t=1;t<=r;t++)this.last.day=t,this.is_day_in_byday(this.last)&&(s++,t<=e&&i++);this.last.day=e}for(e=0,t=this.last.day+1;t<=r;t++)if(this.last.day=t,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++i)||this.check_set_position(i-s-1))){e=1;break}t>r&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?this.has_by_data("BYSETPOS")&&!this.check_set_position(1)||(e=1):e=0)}else if(this.has_by_data("BYMONTHDAY")){if(this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month(),this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length))return 0;let t=a.daysInMonth(this.last.month,this.last.year),r=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];r<0&&(r=t+r+1),r>t?(this.last.day=1,e=this.is_day_in_byday(this.last)):this.last.day=r}else{this.increment_month();let t=a.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>t?e=0:this.last.day=this.by_data.BYMONTHDAY[0]}return e}next_weekday_by_week(){let e=0;if(0==this.next_hour())return e;if(!this.has_by_data("BYDAY"))return 1;for(;;){let t=new a;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,e=1);let r=this.by_data.BYDAY[this.by_indices.BYDAY],i=this.ruleDayOfWeek(r)[1];i-=this.rule.wkst,i<0&&(i+=7),t.year=this.last.year,t.month=this.last.month,t.day=this.last.day;let s=t.startDoyWeek(this.rule.wkst);if(i+s<1&&!e)continue;let n=a.fromDayOfYear(s+i,this.last.year);return this.last.year=n.year,this.last.month=n.month,this.last.day=n.day,e}}next_year(){return 0==this.next_hour()?0:0!=this.days.length&&++this.days_index!=this.days.length||(this.days_index=0,this.increment_year(this.rule.interval),this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY)),this.expand_year_days(this.last.year),0!=this.days.length)?this._nextByYearDay():0}_nextByYearDay(){let e=this.days[this.days_index],t=this.last.year;if(366==Math.abs(e)&&!a.isLeapYear(this.last.year))return 0;e<1&&(e+=1,t+=1);let r=a.fromDayOfYear(e,t);return this.last.day=r.day,this.last.month=r.month,1}ruleDayOfWeek(e,t){let r=e.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(r){return[parseInt(r[1]||0,10),e=L.icalDayToNumericDay(r[2],t)]}return[0,0]}next_generic(e,t,r,i,s){let a=e in this.by_data,n=this.rule.freq==t,o=0;if(s&&0==this[s]())return o;if(a){this.by_indices[e]++;let t=this.by_data[e];this.by_indices[e]==t.length&&(this.by_indices[e]=0,o=1),this.last[r]=t[this.by_indices[e]]}else n&&this["increment_"+r](this.rule.interval);return a&&o&&n&&this["increment_"+i](1),o}increment_monthday(e){for(let t=0;t<e;t++){let e=a.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>e&&(this.last.day-=e,this.increment_month())}}increment_month(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{"MONTHLY"==this.rule.freq?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;let e=b(this.last.month/12);this.last.month%=12,this.last.month++,0!=e&&this.increment_year(e)}this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY))}increment_year(e){this.last.day=1,this.last.year+=e}increment_generic(e,t,r,i){this.last[t]+=e;let s=b(this.last[t]/r);this.last[t]%=r,0!=s&&this["increment_"+i](s)}has_by_data(e){return e in this.rule.parts}expand_year_days(e){let t=new a;this.days=[];let r={},i=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(let e of i)e in this.rule.parts&&(r[e]=this.rule.parts[e]);if("BYMONTH"in r&&"BYWEEKNO"in r){let i=1,s={};t.year=e,t.isDate=!0;for(let r=0;r<this.by_data.BYMONTH.length;r++){let i=this.by_data.BYMONTH[r];t.month=i,t.day=1;let n=t.weekNumber(this.rule.wkst);t.day=a.daysInMonth(i,e);let o=t.weekNumber(this.rule.wkst);for(r=n;r<o;r++)s[r]=1}for(let e=0;e<this.by_data.BYWEEKNO.length&&i;e++){this.by_data.BYWEEKNO[e]<52?i&=s[e]:i=0}i?delete r.BYMONTH:delete r.BYWEEKNO}let s=Object.keys(r).length;if(0==s){let e=this.dtstart.clone();e.year=this.last.year,this.days.push(e.dayOfYear())}else if(1==s&&"BYMONTH"in r)for(let t of this.by_data.BYMONTH){let r=this.dtstart.clone();r.year=e,r.month=t,r.isDate=!0,this.days.push(r.dayOfYear())}else if(1==s&&"BYMONTHDAY"in r)for(let t of this.by_data.BYMONTHDAY){let r=this.dtstart.clone();if(t<0){t=t+a.daysInMonth(r.month,e)+1}r.day=t,r.year=e,r.isDate=!0,this.days.push(r.dayOfYear())}else if(2==s&&"BYMONTHDAY"in r&&"BYMONTH"in r)for(let r of this.by_data.BYMONTH){let i=a.daysInMonth(r,e);for(let s of this.by_data.BYMONTHDAY)s<0&&(s=s+i+1),t.day=s,t.month=r,t.year=e,t.isDate=!0,this.days.push(t.dayOfYear())}else if(1==s&&"BYWEEKNO"in r);else if(2==s&&"BYWEEKNO"in r&&"BYMONTHDAY"in r);else if(1==s&&"BYDAY"in r)this.days=this.days.concat(this.expand_by_day(e));else if(2==s&&"BYDAY"in r&&"BYMONTH"in r){for(let r of this.by_data.BYMONTH){let i=a.daysInMonth(r,e);t.year=e,t.month=r,t.day=1,t.isDate=!0;let s=t.dayOfWeek(),n=t.dayOfYear()-1;t.day=i;let o=t.dayOfWeek();if(this.has_by_data("BYSETPOS")){let e=[];for(let r=1;r<=i;r++)t.day=r,this.is_day_in_byday(t)&&e.push(r);for(let t=0;t<e.length;t++)(this.check_set_position(t+1)||this.check_set_position(t-e.length))&&this.days.push(n+e[t])}else for(let e of this.by_data.BYDAY){let t,r=this.ruleDayOfWeek(e),a=r[0],l=r[1],c=(l+7-s)%7+1,u=i-(o+7-l)%7;if(0==a)for(let e=c;e<=i;e+=7)this.days.push(n+e);else a>0?(t=c+7*(a-1),t<=i&&this.days.push(n+t)):(t=u+7*(a+1),t>0&&this.days.push(n+t))}}this.days.sort((function(e,t){return e-t}))}else if(2==s&&"BYDAY"in r&&"BYMONTHDAY"in r){let t=this.expand_by_day(e);for(let r of t){let t=a.fromDayOfYear(r,e);this.by_data.BYMONTHDAY.indexOf(t.day)>=0&&this.days.push(r)}}else if(3==s&&"BYDAY"in r&&"BYMONTHDAY"in r&&"BYMONTH"in r){let t=this.expand_by_day(e);for(let r of t){let t=a.fromDayOfYear(r,e);this.by_data.BYMONTH.indexOf(t.month)>=0&&this.by_data.BYMONTHDAY.indexOf(t.day)>=0&&this.days.push(r)}}else if(2==s&&"BYDAY"in r&&"BYWEEKNO"in r){let t=this.expand_by_day(e);for(let r of t){let t=a.fromDayOfYear(r,e).weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(t)&&this.days.push(r)}}else if(3==s&&"BYDAY"in r&&"BYWEEKNO"in r&&"BYMONTHDAY"in r);else if(1==s&&"BYYEARDAY"in r)this.days=this.days.concat(this.by_data.BYYEARDAY);else if(2==s&&"BYYEARDAY"in r&&"BYDAY"in r){let t=a.isLeapYear(e)?366:365,r=new Set(this.expand_by_day(e));for(let e of this.by_data.BYYEARDAY)e<0&&(e+=t+1),r.has(e)&&this.days.push(e)}else this.days=[];let n=a.isLeapYear(e)?366:365;return this.days.sort(((e,t)=>(e<0&&(e+=n+1),t<0&&(t+=n+1),e-t))),0}expand_by_day(e){let t=[],r=this.last.clone();r.year=e,r.month=1,r.day=1,r.isDate=!0;let i=r.dayOfWeek();r.month=12,r.day=31,r.isDate=!0;let s=r.dayOfWeek(),a=r.dayOfYear();for(let e of this.by_data.BYDAY){let r=this.ruleDayOfWeek(e),n=r[0],o=r[1];if(0==n){for(let e=(o+7-i)%7+1;e<=a;e+=7)t.push(e)}else if(n>0){let e;e=o>=i?o-i+1:o-i+8,t.push(e+7*(n-1))}else{let e;n=-n,e=o<=s?a-s+o:a-s+o-7,t.push(e-7*(n-1))}}return t}is_day_in_byday(e){if(this.by_data.BYDAY)for(let t of this.by_data.BYDAY){let r=this.ruleDayOfWeek(t),i=r[0],s=r[1],a=e.dayOfWeek();if(0==i&&s==a||e.nthWeekDay(s,i)==e.day)return 1}return 0}check_set_position(e){if(this.has_by_data("BYSETPOS")){return-1!==this.by_data.BYSETPOS.indexOf(e)}return!1}sort_byday_rules(e){for(let t=0;t<e.length;t++)for(let r=0;r<t;r++){if(this.ruleDayOfWeek(e[r],this.rule.wkst)[1]>this.ruleDayOfWeek(e[t],this.rule.wkst)[1]){let i=e[t];e[t]=e[r],e[r]=i}}}check_contract_restriction(e,t){let r=x._indexMap[e],i=x._expandMap[this.rule.freq][r],s=!1;if(e in this.by_data&&i==x.CONTRACT){let r=this.by_data[e];for(let e of r)if(e==t){s=!0;break}}else s=!0;return s}check_contracting_rules(){let e=this.last.dayOfWeek(),t=this.last.weekNumber(this.rule.wkst),r=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",L.numericDayToIcalDay(e))&&this.check_contract_restriction("BYWEEKNO",t)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",r)}setup_defaults(e,t,r){let i=x._indexMap[e];return x._expandMap[this.rule.freq][i]!=x.CONTRACT&&(e in this.by_data||(this.by_data[e]=[r]),this.rule.freq!=t)?this.by_data[e][0]:r}toJSON(){let e=Object.create(null);return e.initialized=this.initialized,e.rule=this.rule.toJSON(),e.dtstart=this.dtstart.toJSON(),e.by_data=this.by_data,e.days=this.days,e.last=this.last.toJSON(),e.by_indices=this.by_indices,e.occurrence_number=this.occurrence_number,e}}class N extends Error{constructor(){super("Recurrence rule has no valid occurrences")}}const v=/^(SU|MO|TU|WE|TH|FR|SA)$/,I=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,B={SU:a.SUNDAY,MO:a.MONDAY,TU:a.TUESDAY,WE:a.WEDNESDAY,TH:a.THURSDAY,FR:a.FRIDAY,SA:a.SATURDAY},M=Object.fromEntries(Object.entries(B).map((e=>e.reverse()))),z=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"];class L{static fromString(e){let t=this._stringToData(e,!1);return new L(t)}static fromData(e){return new L(e)}static _stringToData(e,t){let r=Object.create(null),i=e.split(";"),s=i.length;for(let e=0;e<s;e++){let s=i[e].split("="),a=s[0].toUpperCase(),n=s[0].toLowerCase(),o=t?n:a,l=s[1];if(a in U){let e=l.split(","),t=new Set;for(let r of e)t.add(U[a](r));e=[...t],r[o]=1==e.length?e[0]:e}else a in P?P[a](l,r,t):r[n]=l}return r}static icalDayToNumericDay(e,t){let r=t||a.SUNDAY;return(B[e]-r+7)%7+1}static numericDayToIcalDay(e,t){let r=e+(t||a.SUNDAY)-a.SUNDAY;return r>7&&(r-=7),M[r]}constructor(e){this.wrappedJSObject=this,this.parts={},e&&"object"==typeof e&&this.fromData(e)}parts=null;interval=1;wkst=a.MONDAY;until=null;count=null;freq=null;icalclass="icalrecur";icaltype="recur";iterator(e){return new x({rule:this,dtstart:e})}clone(){return new L(this.toJSON())}isFinite(){return!(!this.count&&!this.until)}isByCount(){return!(!this.count||this.until)}addComponent(e,t){let r=e.toUpperCase();r in this.parts?this.parts[r].push(t):this.parts[r]=[t]}setComponent(e,t){this.parts[e.toUpperCase()]=t.slice()}getComponent(e){let t=e.toUpperCase();return t in this.parts?this.parts[t].slice():[]}getNextOccurrence(e,t){let r,i=this.iterator(e);do{r=i.next()}while(r&&r.compare(t)<=0);return r&&t.zone&&(r.zone=t.zone),r}fromData(e){for(let t in e){let r=t.toUpperCase();r in U?Array.isArray(e[t])?this.parts[r]=e[t]:this.parts[r]=[e[t]]:this[t]=e[t]}this.interval&&"number"!=typeof this.interval&&P.INTERVAL(this.interval,this),this.wkst&&"number"!=typeof this.wkst&&(this.wkst=L.icalDayToNumericDay(this.wkst)),!this.until||this.until instanceof a||(this.until=a.fromString(this.until))}toJSON(){let e=Object.create(null);e.freq=this.freq,this.count&&(e.count=this.count),this.interval>1&&(e.interval=this.interval);for(let[t,r]of Object.entries(this.parts))Array.isArray(r)&&1==r.length?e[t.toLowerCase()]=r[0]:e[t.toLowerCase()]=Y(r);return this.until&&(e.until=this.until.toString()),"wkst"in this&&this.wkst!==a.DEFAULT_WEEK_START&&(e.wkst=L.numericDayToIcalDay(this.wkst)),e}toString(){let e="FREQ="+this.freq;this.count&&(e+=";COUNT="+this.count),this.interval>1&&(e+=";INTERVAL="+this.interval);for(let[t,r]of Object.entries(this.parts))e+=";"+t+"="+r;return this.until&&(e+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==a.DEFAULT_WEEK_START&&(e+=";WKST="+L.numericDayToIcalDay(this.wkst)),e}}function k(e,t,r,i){let s=i;if("+"===i[0]&&(s=i.slice(1)),s=_(s),void 0!==t&&i<t)throw new Error(e+': invalid value "'+i+'" must be > '+t);if(void 0!==r&&i>r)throw new Error(e+': invalid value "'+i+'" must be < '+t);return s}const P={FREQ:function(e,t,r){if(-1===z.indexOf(e))throw new Error('invalid frequency "'+e+'" expected: "'+z.join(", ")+'"');t.freq=e},COUNT:function(e,t,r){t.count=_(e)},INTERVAL:function(e,t,r){t.interval=_(e),t.interval<1&&(t.interval=1)},UNTIL:function(e,t,r){e.length>10?t.until=ct.icalendar.value["date-time"].fromICAL(e):t.until=ct.icalendar.value.date.fromICAL(e),r||(t.until=a.fromString(t.until))},WKST:function(e,t,r){if(!v.test(e))throw new Error('invalid WKST value "'+e+'"');t.wkst=L.icalDayToNumericDay(e)}},U={BYSECOND:k.bind(void 0,"BYSECOND",0,60),BYMINUTE:k.bind(void 0,"BYMINUTE",0,59),BYHOUR:k.bind(void 0,"BYHOUR",0,23),BYDAY:function(e){if(I.test(e))return e;throw new Error('invalid BYDAY value "'+e+'"')},BYMONTHDAY:k.bind(void 0,"BYMONTHDAY",-31,31),BYYEARDAY:k.bind(void 0,"BYYEARDAY",-366,366),BYWEEKNO:k.bind(void 0,"BYWEEKNO",-53,53),BYMONTH:k.bind(void 0,"BYMONTH",1,12),BYSETPOS:k.bind(void 0,"BYSETPOS",-366,366)},j=/\\\\|\\,|\\[Nn]/g,V=/\\|,|\n/g;function H(e,t){return{matches:/.*/,fromICAL:function(t,r){return function(e,t,r){if(-1===e.indexOf("\\"))return e;r&&(t=new RegExp(t.source+"|\\\\"+r,t.flags));return e.replace(t,$)}(t,e,r)},toICAL:function(e,r){let i=t;return r&&(i=new RegExp(i.source+"|"+r,i.flags)),e.replace(i,(function(e){switch(e){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case"\n":return"\\n";default:return e}}))}}}const R={defaultType:"text"},W={defaultType:"text",multiValue:","},F={defaultType:"text",structuredValue:";"},K={defaultType:"integer"},q={defaultType:"date-time",allowedTypes:["date-time","date"]},J={defaultType:"date-time"},Z={defaultType:"uri"},G={defaultType:"utc-offset"},X={defaultType:"recur"},Q={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function $(e){switch(e){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return"\n";default:return e}}let tt={categories:W,url:Z,version:R,uid:R},et={boolean:{values:["TRUE","FALSE"],fromICAL:function(e){return"TRUE"===e},toICAL:function(e){return e?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(e){let t=parseFloat(e);return y(t)?0:t},toICAL:function(e){return String(e)}},integer:{fromICAL:function(e){let t=parseInt(e);return y(t)?0:t},toICAL:function(e){return String(e)}},"utc-offset":{toICAL:function(e){return e.length<7?e.slice(0,3)+e.slice(4,6):e.slice(0,3)+e.slice(4,6)+e.slice(7,9)},fromICAL:function(e){return e.length<6?e.slice(0,3)+":"+e.slice(3,5):e.slice(0,3)+":"+e.slice(3,5)+":"+e.slice(5,7)},decorate:function(e){return w.fromString(e)},undecorate:function(e){return e.toString()}}};const it=S(et,{text:H(/\\\\|\\;|\\,|\\[Nn]/g,/\\|;|,|\n/g),uri:{},binary:{decorate:function(e){return t.fromString(e)},undecorate:function(e){return e.toString()}},"cal-address":{},date:{decorate:function(e,t){return ct.strict?a.fromDateString(e,t):a.fromString(e,t)},undecorate:function(e){return e.toString()},fromICAL:function(e){return!ct.strict&&e.length>=15?it["date-time"].fromICAL(e):e.slice(0,4)+"-"+e.slice(4,6)+"-"+e.slice(6,8)},toICAL:function(e){let t=e.length;return 10==t?e.slice(0,4)+e.slice(5,7)+e.slice(8,10):t>=19?it["date-time"].toICAL(e):e}},"date-time":{fromICAL:function(e){if(ct.strict||8!=e.length){let t=e.slice(0,4)+"-"+e.slice(4,6)+"-"+e.slice(6,8)+"T"+e.slice(9,11)+":"+e.slice(11,13)+":"+e.slice(13,15);return e[15]&&"Z"===e[15]&&(t+="Z"),t}return it.date.fromICAL(e)},toICAL:function(e){let t=e.length;if(10!=t||ct.strict){if(t>=19){let t=e.slice(0,4)+e.slice(5,7)+e.slice(8,13)+e.slice(14,16)+e.slice(17,19);return e[19]&&"Z"===e[19]&&(t+="Z"),t}return e}return it.date.toICAL(e)},decorate:function(e,t){return ct.strict?a.fromDateTimeString(e,t):a.fromString(e,t)},undecorate:function(e){return e.toString()}},duration:{decorate:function(e){return r.fromString(e)},undecorate:function(e){return e.toString()}},period:{fromICAL:function(e){let t=e.split("/");return t[0]=it["date-time"].fromICAL(t[0]),r.isValueString(t[1])||(t[1]=it["date-time"].fromICAL(t[1])),t},toICAL:function(e){return e=e.slice(),ct.strict||10!=e[0].length?e[0]=it["date-time"].toICAL(e[0]):e[0]=it.date.toICAL(e[0]),r.isValueString(e[1])||(ct.strict||10!=e[1].length?e[1]=it["date-time"].toICAL(e[1]):e[1]=it.date.toICAL(e[1])),e.join("/")},decorate:function(e,t){return s.fromJSON(e,t,!ct.strict)},undecorate:function(e){return e.toJSON()}},recur:{fromICAL:function(e){return L._stringToData(e,!0)},toICAL:function(e){let t="";for(let[r,i]of Object.entries(e))"until"==r?i=i.length>10?it["date-time"].toICAL(i):it.date.toICAL(i):"wkst"==r?"number"==typeof i&&(i=L.numericDayToIcalDay(i)):Array.isArray(i)&&(i=i.join(",")),t+=r.toUpperCase()+"="+i+";";return t.slice(0,Math.max(0,t.length-1))},decorate:function(e){return L.fromData(e)},undecorate:function(e){return e.toJSON()}},time:{fromICAL:function(e){if(e.length<6)return e;let t=e.slice(0,2)+":"+e.slice(2,4)+":"+e.slice(4,6);return"Z"===e[6]&&(t+="Z"),t},toICAL:function(e){if(e.length<8)return e;let t=e.slice(0,2)+e.slice(3,5)+e.slice(6,8);return"Z"===e[8]&&(t+="Z"),t}}});let rt=S(tt,{action:R,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:R,class:R,comment:R,completed:J,contact:R,created:J,description:R,dtend:q,dtstamp:J,dtstart:q,due:q,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:X,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":J,location:R,method:R,organizer:{defaultType:"cal-address"},"percent-complete":K,priority:K,prodid:R,"related-to":R,repeat:K,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(e){return-1!==e.indexOf("/")?"period":-1===e.indexOf("T")?"date":"date-time"}},"recurrence-id":q,resources:W,"request-status":F,rrule:X,sequence:K,status:R,summary:R,transp:R,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:G,tzoffsetto:G,tzurl:Z,tzid:R,tzname:R});const nt=S(et,{text:H(j,V),uri:H(j,V),date:{decorate:function(e){return C.fromDateAndOrTimeString(e,"date")},undecorate:function(e){return e.toString()},fromICAL:function(e){return 8==e.length?it.date.fromICAL(e):"-"==e[0]&&6==e.length?e.slice(0,4)+"-"+e.slice(4):e},toICAL:function(e){return 10==e.length?it.date.toICAL(e):"-"==e[0]&&7==e.length?e.slice(0,4)+e.slice(5):e}},time:{decorate:function(e){return C.fromDateAndOrTimeString("T"+e,"time")},undecorate:function(e){return e.toString()},fromICAL:function(e){let t=nt.time._splitZone(e,!0),r=t[0],i=t[1];return 6==i.length?i=i.slice(0,2)+":"+i.slice(2,4)+":"+i.slice(4,6):4==i.length&&"-"!=i[0]?i=i.slice(0,2)+":"+i.slice(2,4):5==i.length&&(i=i.slice(0,3)+":"+i.slice(3,5)),5!=r.length||"-"!=r[0]&&"+"!=r[0]||(r=r.slice(0,3)+":"+r.slice(3)),i+r},toICAL:function(e){let t=nt.time._splitZone(e),r=t[0],i=t[1];return 8==i.length?i=i.slice(0,2)+i.slice(3,5)+i.slice(6,8):5==i.length&&"-"!=i[0]?i=i.slice(0,2)+i.slice(3,5):6==i.length&&(i=i.slice(0,3)+i.slice(4,6)),6!=r.length||"-"!=r[0]&&"+"!=r[0]||(r=r.slice(0,3)+r.slice(4)),i+r},_splitZone:function(e,t){let r,i,s=e.length-1,a=e.length-(t?5:6),n=e[a];return"Z"==e[s]?(r=e[s],i=e.slice(0,Math.max(0,s))):e.length>6&&("-"==n||"+"==n)?(r=e.slice(a),i=e.slice(0,Math.max(0,a))):(r="",i=e),[r,i]}},"date-time":{decorate:function(e){return C.fromDateAndOrTimeString(e,"date-time")},undecorate:function(e){return e.toString()},fromICAL:function(e){return nt["date-and-or-time"].fromICAL(e)},toICAL:function(e){return nt["date-and-or-time"].toICAL(e)}},"date-and-or-time":{decorate:function(e){return C.fromDateAndOrTimeString(e,"date-and-or-time")},undecorate:function(e){return e.toString()},fromICAL:function(e){let t=e.split("T");return(t[0]?nt.date.fromICAL(t[0]):"")+(t[1]?"T"+nt.time.fromICAL(t[1]):"")},toICAL:function(e){let t=e.split("T");return nt.date.toICAL(t[0])+(t[1]?"T"+nt.time.toICAL(t[1]):"")}},timestamp:it["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/},"phone-number":{fromICAL:function(e){return Array.from(e).filter((function(e){return"\\"===e?void 0:e})).join("")},toICAL:function(e){return Array.from(e).map((function(e){return","===e||";"===e?"\\"+e:e})).join("")}}});let st=S(tt,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:Q,bday:Q,caladruri:Z,caluri:Z,clientpidmap:F,email:R,fburl:Z,fn:R,gender:F,geo:Z,impp:Z,key:Z,kind:R,lang:{defaultType:"language-tag"},logo:Z,member:Z,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:W,note:R,org:{defaultType:"text",structuredValue:";"},photo:Z,related:Z,rev:{defaultType:"timestamp"},role:R,sound:Z,source:Z,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:R,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:R}),at=S(et,{binary:it.binary,date:nt.date,"date-time":nt["date-time"],"phone-number":nt["phone-number"],uri:it.uri,text:nt.text,time:it.time,vcard:it.text,"utc-offset":{toICAL:function(e){return e.slice(0,7)},fromICAL:function(e){return e.slice(0,7)},decorate:function(e){return w.fromString(e)},undecorate:function(e){return e.toString()}}}),ot=S(tt,{fn:R,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:W,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(e){return-1===e.indexOf("T")?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:R,tel:{defaultType:"phone-number"},email:R,mailer:R,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:R,role:R,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:F,note:W,prodid:R,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(e){return-1===e.indexOf("T")?"date":"date-time"}},"sort-string":R,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:R,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),lt={name:"ical",value:it,param:{cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}},property:rt,propertyGroups:!1},ht={name:"vcard4",value:nt,param:{type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},property:st,propertyGroups:!0},ut={name:"vcard3",value:at,param:{type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},property:ot,propertyGroups:!0};const ct={strict:!0,defaultSet:lt,defaultType:"unknown",components:{vcard:ht,vcard3:ut,vevent:lt,vtodo:lt,vjournal:lt,valarm:lt,vtimezone:lt,daylight:lt,standard:lt},icalendar:lt,vcard:ht,vcard3:ut,getDesignSet:function(e){return e&&e in ct.components?ct.components[e]:ct.defaultSet}},dt="\r\n",mt="unknown",ft={'"':"^'","\n":"^n","^":"^^"};function pt(e){"string"==typeof e[0]&&(e=[e]);let t=0,r=e.length,i="";for(;t<r;t++)i+=pt.component(e[t])+dt;return i}pt.component=function(e,t){let r=e[0].toUpperCase(),i="BEGIN:"+r+dt,s=e[1],a=0,n=s.length,o=e[0];for("vcard"===o&&e[1].length>0&&("version"!==e[1][0][0]||"4.0"!==e[1][0][3])&&(o="vcard3"),t=t||ct.getDesignSet(o);a<n;a++)i+=pt.property(s[a],t)+dt;let l=e[2]||[],c=0,u=l.length;for(;c<u;c++)i+=pt.component(l[c],t)+dt;return i+="END:"+r,i},pt.property=function(e,t,r){let i=e[0].toUpperCase(),s=e[0],a=e[1];t||(t=ct.defaultSet);let n,o=a.group;n=t.propertyGroups&&o?o.toUpperCase()+"."+i:i;for(let[e,r]of Object.entries(a)){if(t.propertyGroups&&"group"==e)continue;let i=t.param[e],s=i&&i.multiValue;s&&Array.isArray(r)?(r=r.map((function(e){return e=pt._rfc6868Unescape(e),e=pt.paramPropertyValue(e,i.multiValueSeparateDQuote)})),r=pt.multiValue(r,s,"unknown",null,t)):(r=pt._rfc6868Unescape(r),r=pt.paramPropertyValue(r)),n+=";"+e.toUpperCase()+"="+r}if(3===e.length)return n+":";let l,c=e[2],u=!1,h=!1,d=!1;return s in t.property?(l=t.property[s],"multiValue"in l&&(u=l.multiValue),"structuredValue"in l&&Array.isArray(e[3])&&(h=l.structuredValue),"defaultType"in l?c===l.defaultType&&(d=!0):c===mt&&(d=!0)):c===mt&&(d=!0),d||(n+=";VALUE="+c.toUpperCase()),n+=":",n+=u&&h?pt.multiValue(e[3],h,c,u,t,h):u?pt.multiValue(e.slice(3),u,c,null,t,!1):h?pt.multiValue(e[3],h,c,null,t,h):pt.value(e[3],c,t,!1),r?n:A(n)},pt.paramPropertyValue=function(e,t){return t||-1!==e.indexOf(",")||-1!==e.indexOf(":")||-1!==e.indexOf(";")?'"'+e+'"':e},pt.multiValue=function(e,t,r,i,s,a){let n="",o=e.length,l=0;for(;l<o;l++)i&&Array.isArray(e[l])?n+=pt.multiValue(e[l],i,r,null,s,a):n+=pt.value(e[l],r,s,a),l!==o-1&&(n+=t);return n},pt.value=function(e,t,r,i){return t in r.value&&"toICAL"in r.value[t]?r.value[t].toICAL(e,i):e},pt._rfc6868Unescape=function(e){return e.replace(/[\n^"]/g,(function(e){return ft[e]}))};class yt{static fromString(e,t){return new yt(u.property(e,t))}constructor(e,t){this._parent=t||null,"string"==typeof e?(this.jCal=[e,{},ct.defaultType],this.jCal[2]=this.getDefaultType()):this.jCal=e,this._updateType()}get type(){return this.jCal[2]}get name(){return this.jCal[0]}get parent(){return this._parent}set parent(e){let t=!this._parent||e&&e._designSet!=this._parent._designSet;this._parent=e,this.type==ct.defaultType&&t&&(this.jCal[2]=this.getDefaultType(),this._updateType())}get _designSet(){return this.parent?this.parent._designSet:ct.defaultSet}_updateType(){let e=this._designSet;this.type in e.value&&("decorate"in e.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in e.property&&(this.isMultiValue="multiValue"in e.property[this.name],this.isStructuredValue="structuredValue"in e.property[this.name]))}_hydrateValue(e){return this._values&&this._values[e]?this._values[e]:this.jCal.length<=3+e?null:this.isDecorated?(this._values||(this._values=[]),this._values[e]=this._decorate(this.jCal[3+e])):this.jCal[3+e]}_decorate(e){return this._designSet.value[this.type].decorate(e,this)}_undecorate(e){return this._designSet.value[this.type].undecorate(e,this)}_setDecoratedValue(e,t){this._values||(this._values=[]),"object"==typeof e&&"icaltype"in e?(this.jCal[3+t]=this._undecorate(e),this._values[t]=e):(this.jCal[3+t]=e,this._values[t]=this._decorate(e))}getParameter(e){return e in this.jCal[1]?this.jCal[1][e]:void 0}getFirstParameter(e){let t=this.getParameter(e);return Array.isArray(t)?t[0]:t}setParameter(e,t){let r=e.toLowerCase();"string"==typeof t&&r in this._designSet.param&&"multiValue"in this._designSet.param[r]&&(t=[t]),this.jCal[1][e]=t}removeParameter(e){delete this.jCal[1][e]}getDefaultType(){let e=this.jCal[0],t=this._designSet;if(e in t.property){let r=t.property[e];if("defaultType"in r)return r.defaultType}return ct.defaultType}resetType(e){this.removeAllValues(),this.jCal[2]=e,this._updateType()}getFirstValue(){return this._hydrateValue(0)}getValues(){let e=this.jCal.length-3;if(e<1)return[];let t=0,r=[];for(;t<e;t++)r[t]=this._hydrateValue(t);return r}removeAllValues(){this._values&&(this._values.length=0),this.jCal.length=3}setValues(e){if(!this.isMultiValue)throw new Error(this.name+": does not not support mulitValue.\noverride isMultiValue");let t=e.length,r=0;if(this.removeAllValues(),t>0&&"object"==typeof e[0]&&"icaltype"in e[0]&&this.resetType(e[0].icaltype),this.isDecorated)for(;r<t;r++)this._setDecoratedValue(e[r],r);else for(;r<t;r++)this.jCal[3+r]=e[r]}setValue(e){this.removeAllValues(),"object"==typeof e&&"icaltype"in e&&this.resetType(e.icaltype),this.isDecorated?this._setDecoratedValue(e,0):this.jCal[3]=e}toJSON(){return this.jCal}toICALString(){return pt.property(this.jCal,this._designSet,!0)}}class _t{static fromString(e){return new _t(u.component(e))}constructor(e,t){"string"==typeof e&&(e=[e,[],[]]),this.jCal=e,this.parent=t||null,this.parent||"vcalendar"!==this.name||(this._timezoneCache=new Map)}_hydratedPropertyCount=0;_hydratedComponentCount=0;_timezoneCache=null;_components=null;_properties=null;get name(){return this.jCal[0]}get _designSet(){let e=this.parent&&this.parent._designSet;if(!e&&"vcard"==this.name){let e=this.jCal[1]?.[0];if(e&&"version"==e[0]&&"3.0"==e[3])return ct.getDesignSet("vcard3")}return e||ct.getDesignSet(this.name)}_hydrateComponent(e){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[e])return this._components[e];let t=new _t(this.jCal[2][e],this);return this._hydratedComponentCount++,this._components[e]=t}_hydrateProperty(e){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[e])return this._properties[e];let t=new yt(this.jCal[1][e],this);return this._hydratedPropertyCount++,this._properties[e]=t}getFirstSubcomponent(e){if(e){let t=0,r=this.jCal[2],i=r.length;for(;t<i;t++)if(r[t][0]===e){return this._hydrateComponent(t)}}else if(this.jCal[2].length)return this._hydrateComponent(0);return null}getAllSubcomponents(e){let t=this.jCal[2].length,r=0;if(e){let i=this.jCal[2],s=[];for(;r<t;r++)e===i[r][0]&&s.push(this._hydrateComponent(r));return s}if(!this._components||this._hydratedComponentCount!==t)for(;r<t;r++)this._hydrateComponent(r);return this._components||[]}hasProperty(e){let t=this.jCal[1],r=t.length,i=0;for(;i<r;i++)if(t[i][0]===e)return!0;return!1}getFirstProperty(e){if(e){let t=0,r=this.jCal[1],i=r.length;for(;t<i;t++)if(r[t][0]===e){return this._hydrateProperty(t)}}else if(this.jCal[1].length)return this._hydrateProperty(0);return null}getFirstPropertyValue(e){let t=this.getFirstProperty(e);return t?t.getFirstValue():null}getAllProperties(e){let t=this.jCal[1].length,r=0;if(e){let i=this.jCal[1],s=[];for(;r<t;r++)e===i[r][0]&&s.push(this._hydrateProperty(r));return s}if(!this._properties||this._hydratedPropertyCount!==t)for(;r<t;r++)this._hydrateProperty(r);return this._properties||[]}_removeObjectByIndex(e,t,r){if((t=t||[])[r]){let e=t[r];"parent"in e&&(e.parent=null)}t.splice(r,1),this.jCal[e].splice(r,1)}_removeObject(e,t,r){let i=0,s=this.jCal[e],a=s.length,n=this[t];if("string"==typeof r){for(;i<a;i++)if(s[i][0]===r)return this._removeObjectByIndex(e,n,i),!0}else if(n)for(;i<a;i++)if(n[i]&&n[i]===r)return this._removeObjectByIndex(e,n,i),!0;return!1}_removeAllObjects(e,t,r){let i=this[t],s=this.jCal[e],a=s.length-1;for(;a>=0;a--)r&&s[a][0]!==r||this._removeObjectByIndex(e,i,a)}addSubcomponent(e){this._components||(this._components=[],this._hydratedComponentCount=0),e.parent&&e.parent.removeSubcomponent(e);let t=this.jCal[2].push(e.jCal);return this._components[t-1]=e,this._hydratedComponentCount++,e.parent=this,e}removeSubcomponent(e){let t=this._removeObject(2,"_components",e);return t&&this._hydratedComponentCount--,t}removeAllSubcomponents(e){let t=this._removeAllObjects(2,"_components",e);return this._hydratedComponentCount=0,t}addProperty(e){if(!(e instanceof yt))throw new TypeError("must be instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),e.parent&&e.parent.removeProperty(e);let t=this.jCal[1].push(e.jCal);return this._properties[t-1]=e,this._hydratedPropertyCount++,e.parent=this,e}addPropertyWithValue(e,t){let r=new yt(e);return r.setValue(t),this.addProperty(r),r}updatePropertyWithValue(e,t){let r=this.getFirstProperty(e);return r?r.setValue(t):r=this.addPropertyWithValue(e,t),r}removeProperty(e){let t=this._removeObject(1,"_properties",e);return t&&this._hydratedPropertyCount--,t}removeAllProperties(e){let t=this._removeAllObjects(1,"_properties",e);return this._hydratedPropertyCount=0,t}toJSON(){return this.jCal}toString(){return pt.component(this.jCal,this._designSet)}getTimeZoneByID(e){if(this.parent)return this.parent.getTimeZoneByID(e);if(!this._timezoneCache)return null;if(this._timezoneCache.has(e))return this._timezoneCache.get(e);const t=this.getAllSubcomponents("vtimezone");for(const r of t)if(r.getFirstProperty("tzid").getFirstValue()===e){const t=new m({component:r,tzid:e});return this._timezoneCache.set(e,t),t}return null}}class gt{constructor(e){this.ruleDates=[],this.exDates=[],this.fromData(e)}complete=!1;ruleIterators=null;ruleDates=null;exDates=null;ruleDateInc=0;exDateInc=0;exDate=null;ruleDate=null;dtstart=null;last=null;fromData(e){let t=g(e.dtstart,a);if(!t)throw new Error(".dtstart (ICAL.Time) must be given");if(this.dtstart=t,e.component)this._init(e.component);else{if(this.last=g(e.last,a)||t.clone(),!e.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=e.ruleIterators.map((function(e){return g(e,x)})),this.ruleDateInc=e.ruleDateInc,this.exDateInc=e.exDateInc,e.ruleDates&&(this.ruleDates=e.ruleDates.map((e=>g(e,a))),this.ruleDate=this.ruleDates[this.ruleDateInc]),e.exDates&&(this.exDates=e.exDates.map((e=>g(e,a))),this.exDate=this.exDates[this.exDateInc]),void 0!==e.complete&&(this.complete=e.complete)}}_compare_special(e,t){return!e.isDate&&t.isDate?new a({year:e.year,month:e.month,day:e.day}).compare(t):e.compare(t)}next(){let e,t,r,i=0;for(;;){if(i++>500)throw new Error("max tries have occurred, rule may be impossible to fulfill.");if(t=this.ruleDate,e=this._nextRecurrenceIter(this.last),!t&&!e){this.complete=!0;break}if((!t||e&&t.compare(e.last)>0)&&(t=e.last.clone(),e.next()),this.ruleDate===t&&this._nextRuleDay(),this.last=t,!this.exDate||(r=this._compare_special(this.last,this.exDate),r>0&&this._nextExDay(),0!==r))return this.last;this._nextExDay()}}toJSON(){function e(e){return e.toJSON()}let t=Object.create(null);return t.ruleIterators=this.ruleIterators.map(e),this.ruleDates&&(t.ruleDates=this.ruleDates.map(e)),this.exDates&&(t.exDates=this.exDates.map(e)),t.ruleDateInc=this.ruleDateInc,t.exDateInc=this.exDateInc,t.last=this.last.toJSON(),t.dtstart=this.dtstart.toJSON(),t.complete=this.complete,t}_extractDates(e,t){let r=[],i=e.getAllProperties(t);for(let e=0,t=i.length;e<t;e++)for(let t of i[e].getValues()){let e=T(r,t,((e,t)=>e.compare(t)));r.splice(e,0,t)}return r}_init(e){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!e.hasProperty("rdate")&&!e.hasProperty("rrule")&&!e.hasProperty("recurrence-id"))return this.ruleDate=this.last.clone(),void(this.complete=!0);if(e.hasProperty("rdate")&&(this.ruleDates=this._extractDates(e,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=T(this.ruleDates,this.last,((e,t)=>e.compare(t))),this.ruleDate=this.ruleDates[this.ruleDateInc]),e.hasProperty("rrule")){let t,r,i=e.getAllProperties("rrule"),s=0,a=i.length;for(;s<a;s++)t=i[s].getFirstValue(),r=t.iterator(this.dtstart),this.ruleIterators.push(r),r.next()}e.hasProperty("exdate")&&(this.exDates=this._extractDates(e,"exdate"),this.exDateInc=T(this.exDates,this.last,this._compare_special),this.exDate=this.exDates[this.exDateInc])}_nextExDay(){this.exDate=this.exDates[++this.exDateInc]}_nextRuleDay(){this.ruleDate=this.ruleDates[++this.ruleDateInc]}_nextRecurrenceIter(){let e=this.ruleIterators;if(0===e.length)return null;let t,r,i,s=e.length,a=0;for(;a<s;a++)t=e[a],r=t.last,t.completed?(s--,0!==a&&a--,e.splice(a,1)):(!i||i.last.compare(r)>0)&&(i=t);return i}}class Dt{constructor(e,t){e instanceof _t||(t=e,e=null),this.component=e||new _t("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],t&&t.strictExceptions&&(this.strictExceptions=t.strictExceptions),t&&t.exceptions?t.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach((function(e){e.hasProperty("recurrence-id")&&this.relateException(e)}),this)}static THISANDFUTURE="THISANDFUTURE";exceptions=null;strictExceptions=!1;relateException(e){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(e instanceof _t&&(e=new Dt(e)),this.strictExceptions&&e.uid!==this.uid)throw new Error("attempted to relate unrelated exception");let t=e.recurrenceId.toString();if(this.exceptions[t]=e,e.modifiesFuture()){let r=[e.recurrenceId.toUnixTime(),t],i=T(this.rangeExceptions,r,Tt);this.rangeExceptions.splice(i,0,r)}}modifiesFuture(){if(!this.component.hasProperty("recurrence-id"))return!1;return this.component.getFirstProperty("recurrence-id").getParameter("range")===Dt.THISANDFUTURE}findRangeException(e){if(!this.rangeExceptions.length)return null;let t=e.toUnixTime(),r=T(this.rangeExceptions,[t],Tt);if(r-=1,r<0)return null;let i=this.rangeExceptions[r];return t<i[0]?null:i[1]}getOccurrenceDetails(e){let t,r=e.toString(),i=e.convertToZone(m.utcTimezone).toString(),s={recurrenceId:e};if(r in this.exceptions)t=s.item=this.exceptions[r],s.startDate=t.startDate,s.endDate=t.endDate,s.item=t;else if(i in this.exceptions)t=this.exceptions[i],s.startDate=t.startDate,s.endDate=t.endDate,s.item=t;else{let t,r=this.findRangeException(e);if(r){let i=this.exceptions[r];s.item=i;let a=this._rangeExceptionCache[r];if(!a){let e=i.recurrenceId.clone(),t=i.startDate.clone();e.zone=t.zone,a=t.subtractDate(e),this._rangeExceptionCache[r]=a}let n=e.clone();n.zone=i.startDate.zone,n.addDuration(a),t=n.clone(),t.addDuration(i.duration),s.startDate=n,s.endDate=t}else t=e.clone(),t.addDuration(this.duration),s.endDate=t,s.startDate=e,s.item=this}return s}iterator(e){return new gt({component:this.component,dtstart:e||this.startDate})}isRecurring(){let e=this.component;return e.hasProperty("rrule")||e.hasProperty("rdate")}isRecurrenceException(){return this.component.hasProperty("recurrence-id")}getRecurrenceTypes(){let e=this.component.getAllProperties("rrule"),t=0,r=e.length,i=Object.create(null);for(;t<r;t++){i[e[t].getFirstValue().freq]=!0}return i}get uid(){return this._firstProp("uid")}set uid(e){this._setProp("uid",e)}get startDate(){return this._firstProp("dtstart")}set startDate(e){this._setTime("dtstart",e)}get endDate(){let e=this._firstProp("dtend");if(!e){let t=this._firstProp("duration");e=this.startDate.clone(),t?e.addDuration(t):e.isDate&&(e.day+=1)}return e}set endDate(e){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",e)}get duration(){let e=this._firstProp("duration");return e||this.endDate.subtractDateTz(this.startDate)}set duration(e){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",e)}get location(){return this._firstProp("location")}set location(e){this._setProp("location",e)}get attendees(){return this.component.getAllProperties("attendee")}get summary(){return this._firstProp("summary")}set summary(e){this._setProp("summary",e)}get description(){return this._firstProp("description")}set description(e){this._setProp("description",e)}get color(){return this._firstProp("color")}set color(e){this._setProp("color",e)}get organizer(){return this._firstProp("organizer")}set organizer(e){this._setProp("organizer",e)}get sequence(){return this._firstProp("sequence")}set sequence(e){this._setProp("sequence",e)}get recurrenceId(){return this._firstProp("recurrence-id")}set recurrenceId(e){this._setTime("recurrence-id",e)}_setTime(e,t){let r=this.component.getFirstProperty(e);r||(r=new yt(e),this.component.addProperty(r)),t.zone===m.localTimezone||t.zone===m.utcTimezone?r.removeParameter("tzid"):r.setParameter("tzid",t.zone.tzid),r.setValue(t)}_setProp(e,t){this.component.updatePropertyWithValue(e,t)}_firstProp(e){return this.component.getFirstPropertyValue(e)}toString(){return this.component.toString()}}function Tt(e,t){return e[0]>t[0]?1:t[0]>e[0]?-1:0}var Yt={foldLength:75,debug:!1,newLineChar:"\r\n",Binary:t,Component:_t,ComponentParser:class{constructor(e){void 0===e&&(e={});for(let[t,r]of Object.entries(e))this[t]=r}parseEvent=!0;parseTimezone=!0;oncomplete=function(){};onerror=function(e){};ontimezone=function(e){};onevent=function(e){};process(e){"string"==typeof e&&(e=u(e)),e instanceof _t||(e=new _t(e));let t,r=e.getAllSubcomponents(),i=0,s=r.length;for(;i<s;i++)switch(t=r[i],t.name){case"vtimezone":if(this.parseTimezone){let e=t.getFirstPropertyValue("tzid");e&&this.ontimezone(new m({tzid:e,component:t}))}break;case"vevent":this.parseEvent&&this.onevent(new Dt(t));break;default:continue}this.oncomplete()}},Duration:r,Event:Dt,Period:s,Property:yt,Recur:L,RecurExpansion:gt,RecurIterator:x,Time:a,Timezone:m,TimezoneService:p,UtcOffset:w,VCardTime:C,parse:u,stringify:pt,design:ct,helpers:E};const PostalMime=(()=>{class e{constructor(e){e=e||{};this.postalMime=e.postalMime;this.root=!!e.parentNode;this.childNodes=[];if(e.parentNode){e.parentNode.childNodes.push(this)}this.state="header";this.headerLines=[];this.decoders=new Map;this.contentType={value:"text/plain",default:true};this.contentTransferEncoding={value:"8bit"};this.contentDisposition={value:""};this.headers=[];this.contentDecoder=false}setupContentDecoder(e){if(/base64/i.test(e)){this.contentDecoder=new C}else if(/quoted-printable/i.test(e)){this.contentDecoder=new N({decoder:w(this.contentType.parsed.params.charset)})}else{this.contentDecoder=new S}}async finalize(){if(this.state==="finished"){return}if(this.state==="header"){this.processHeaders()}let e=this.postalMime.boundaries;for(let t=e.length-1;t>=0;t--){let r=e[t];if(r.node===this){e.splice(t,1);break}}await this.finalizeChildNodes();this.content=this.contentDecoder?await this.contentDecoder.finalize():null;this.state="finished"}async finalizeChildNodes(){for(let e of this.childNodes){await e.finalize()}}parseStructuredHeader(e){let t={value:false,params:{}};let r=false;let i="";let s="value";let a=false;let n=false;let o;for(let l=0,c=e.length;l<c;l++){o=e.charAt(l);switch(s){case"key":if(o==="="){r=i.trim().toLowerCase();s="value";i="";break}i+=o;break;case"value":if(n){i+=o}else if(o==="\\"){n=true;continue}else if(a&&o===a){a=false}else if(!a&&o==='"'){a=o}else if(!a&&o===";"){if(r===false){t.value=i.trim()}else{t.params[r]=i.trim()}s="key";i=""}else{i+=o}n=false;break}}i=i.trim();if(s==="value"){if(r===false){t.value=i}else{t.params[r]=i}}else if(i){t.params[i.toLowerCase()]=""}if(t.value){t.value=t.value.toLowerCase()}O(t);return t}decodeFlowedText(e,t){return e.split(/\r?\n/).reduce(((e,r)=>{if(/ $/.test(e)&&!/(^|\n)-- $/.test(e)){if(t){return e.slice(0,-1)+r}else{return e+r}}else{return e+"\n"+r}})).replace(/^ /gm,"")}getTextContent(){if(!this.content){return""}let e=w(this.contentType.parsed.params.charset).decode(this.content);if(/^flowed$/i.test(this.contentType.parsed.params.format)){e=this.decodeFlowedText(e,/^yes$/i.test(this.contentType.parsed.params.delsp))}return e}processHeaders(){for(let e=this.headerLines.length-1;e>=0;e--){let t=this.headerLines[e];if(e&&/^\s/.test(t)){this.headerLines[e-1]+="\n"+t;this.headerLines.splice(e,1)}else{t=t.replace(/\s+/g," ");let e=t.indexOf(":");let r=e<0?t.trim():t.substr(0,e).trim();let i=e<0?"":t.substr(e+1).trim();this.headers.push({key:r.toLowerCase(),originalKey:r,value:i});switch(r.toLowerCase()){case"content-type":if(this.contentType.default){this.contentType={value:i,parsed:{}}}break;case"content-transfer-encoding":this.contentTransferEncoding={value:i,parsed:{}};break;case"content-disposition":this.contentDisposition={value:i,parsed:{}};break;case"content-id":this.contentId=i;break}}}this.contentType.parsed=this.parseStructuredHeader(this.contentType.value);this.contentType.multipart=/^multipart\//i.test(this.contentType.parsed.value)?this.contentType.parsed.value.substr(this.contentType.parsed.value.indexOf("/")+1):false;if(this.contentType.multipart&&this.contentType.parsed.params.boundary){this.postalMime.boundaries.push({value:y.encode(this.contentType.parsed.params.boundary),node:this})}this.contentDisposition.parsed=this.parseStructuredHeader(this.contentDisposition.value);this.contentTransferEncoding.encoding=this.contentTransferEncoding.value.toLowerCase().split(/[^\w-]/).shift();this.setupContentDecoder(this.contentTransferEncoding.encoding)}feed(e){switch(this.state){case"header":if(!e.length){this.state="body";return this.processHeaders()}this.headerLines.push(w().decode(e));break;case"body":{this.contentDecoder.update(e)}}}}const t={"&AElig":"","&AElig;":"","&AMP":"&","&AMP;":"&","&Aacute":"","&Aacute;":"","&Abreve;":"","&Acirc":"","&Acirc;":"","&Acy;":"","&Afr;":"","&Agrave":"","&Agrave;":"","&Alpha;":"","&Amacr;":"","&And;":"","&Aogon;":"","&Aopf;":"","&ApplyFunction;":"","&Aring":"","&Aring;":"","&Ascr;":"","&Assign;":"","&Atilde":"","&Atilde;":"","&Auml":"","&Auml;":"","&Backslash;":"","&Barv;":"","&Barwed;":"","&Bcy;":"","&Because;":"","&Bernoullis;":"","&Beta;":"","&Bfr;":"","&Bopf;":"","&Breve;":"","&Bscr;":"","&Bumpeq;":"","&CHcy;":"","&COPY":"","&COPY;":"","&Cacute;":"","&Cap;":"","&CapitalDifferentialD;":"","&Cayleys;":"","&Ccaron;":"","&Ccedil":"","&Ccedil;":"","&Ccirc;":"","&Cconint;":"","&Cdot;":"","&Cedilla;":"","&CenterDot;":"","&Cfr;":"","&Chi;":"","&CircleDot;":"","&CircleMinus;":"","&CirclePlus;":"","&CircleTimes;":"","&ClockwiseContourIntegral;":"","&CloseCurlyDoubleQuote;":"","&CloseCurlyQuote;":"","&Colon;":"","&Colone;":"","&Congruent;":"","&Conint;":"","&ContourIntegral;":"","&Copf;":"","&Coproduct;":"","&CounterClockwiseContourIntegral;":"","&Cross;":"","&Cscr;":"","&Cup;":"","&CupCap;":"","&DD;":"","&DDotrahd;":"","&DJcy;":"","&DScy;":"","&DZcy;":"","&Dagger;":"","&Darr;":"","&Dashv;":"","&Dcaron;":"","&Dcy;":"","&Del;":"","&Delta;":"","&Dfr;":"","&DiacriticalAcute;":"","&DiacriticalDot;":"","&DiacriticalDoubleAcute;":"","&DiacriticalGrave;":"`","&DiacriticalTilde;":"","&Diamond;":"","&DifferentialD;":"","&Dopf;":"","&Dot;":"","&DotDot;":"","&DotEqual;":"","&DoubleContourIntegral;":"","&DoubleDot;":"","&DoubleDownArrow;":"","&DoubleLeftArrow;":"","&DoubleLeftRightArrow;":"","&DoubleLeftTee;":"","&DoubleLongLeftArrow;":"","&DoubleLongLeftRightArrow;":"","&DoubleLongRightArrow;":"","&DoubleRightArrow;":"","&DoubleRightTee;":"","&DoubleUpArrow;":"","&DoubleUpDownArrow;":"","&DoubleVerticalBar;":"","&DownArrow;":"","&DownArrowBar;":"","&DownArrowUpArrow;":"","&DownBreve;":"","&DownLeftRightVector;":"","&DownLeftTeeVector;":"","&DownLeftVector;":"","&DownLeftVectorBar;":"","&DownRightTeeVector;":"","&DownRightVector;":"","&DownRightVectorBar;":"","&DownTee;":"","&DownTeeArrow;":"","&Downarrow;":"","&Dscr;":"","&Dstrok;":"","&ENG;":"","&ETH":"","&ETH;":"","&Eacute":"","&Eacute;":"","&Ecaron;":"","&Ecirc":"","&Ecirc;":"","&Ecy;":"","&Edot;":"","&Efr;":"","&Egrave":"","&Egrave;":"","&Element;":"","&Emacr;":"","&EmptySmallSquare;":"","&EmptyVerySmallSquare;":"","&Eogon;":"","&Eopf;":"","&Epsilon;":"","&Equal;":"","&EqualTilde;":"","&Equilibrium;":"","&Escr;":"","&Esim;":"","&Eta;":"","&Euml":"","&Euml;":"","&Exists;":"","&ExponentialE;":"","&Fcy;":"","&Ffr;":"","&FilledSmallSquare;":"","&FilledVerySmallSquare;":"","&Fopf;":"","&ForAll;":"","&Fouriertrf;":"","&Fscr;":"","&GJcy;":"","&GT":">","&GT;":">","&Gamma;":"","&Gammad;":"","&Gbreve;":"","&Gcedil;":"","&Gcirc;":"","&Gcy;":"","&Gdot;":"","&Gfr;":"","&Gg;":"","&Gopf;":"","&GreaterEqual;":"","&GreaterEqualLess;":"","&GreaterFullEqual;":"","&GreaterGreater;":"","&GreaterLess;":"","&GreaterSlantEqual;":"","&GreaterTilde;":"","&Gscr;":"","&Gt;":"","&HARDcy;":"","&Hacek;":"","&Hat;":"^","&Hcirc;":"","&Hfr;":"","&HilbertSpace;":"","&Hopf;":"","&HorizontalLine;":"","&Hscr;":"","&Hstrok;":"","&HumpDownHump;":"","&HumpEqual;":"","&IEcy;":"","&IJlig;":"","&IOcy;":"","&Iacute":"","&Iacute;":"","&Icirc":"","&Icirc;":"","&Icy;":"","&Idot;":"","&Ifr;":"","&Igrave":"","&Igrave;":"","&Im;":"","&Imacr;":"","&ImaginaryI;":"","&Implies;":"","&Int;":"","&Integral;":"","&Intersection;":"","&InvisibleComma;":"","&InvisibleTimes;":"","&Iogon;":"","&Iopf;":"","&Iota;":"","&Iscr;":"","&Itilde;":"","&Iukcy;":"","&Iuml":"","&Iuml;":"","&Jcirc;":"","&Jcy;":"","&Jfr;":"","&Jopf;":"","&Jscr;":"","&Jsercy;":"","&Jukcy;":"","&KHcy;":"","&KJcy;":"","&Kappa;":"","&Kcedil;":"","&Kcy;":"","&Kfr;":"","&Kopf;":"","&Kscr;":"","&LJcy;":"","&LT":"<","&LT;":"<","&Lacute;":"","&Lambda;":"","&Lang;":"","&Laplacetrf;":"","&Larr;":"","&Lcaron;":"","&Lcedil;":"","&Lcy;":"","&LeftAngleBracket;":"","&LeftArrow;":"","&LeftArrowBar;":"","&LeftArrowRightArrow;":"","&LeftCeiling;":"","&LeftDoubleBracket;":"","&LeftDownTeeVector;":"","&LeftDownVector;":"","&LeftDownVectorBar;":"","&LeftFloor;":"","&LeftRightArrow;":"","&LeftRightVector;":"","&LeftTee;":"","&LeftTeeArrow;":"","&LeftTeeVector;":"","&LeftTriangle;":"","&LeftTriangleBar;":"","&LeftTriangleEqual;":"","&LeftUpDownVector;":"","&LeftUpTeeVector;":"","&LeftUpVector;":"","&LeftUpVectorBar;":"","&LeftVector;":"","&LeftVectorBar;":"","&Leftarrow;":"","&Leftrightarrow;":"","&LessEqualGreater;":"","&LessFullEqual;":"","&LessGreater;":"","&LessLess;":"","&LessSlantEqual;":"","&LessTilde;":"","&Lfr;":"","&Ll;":"","&Lleftarrow;":"","&Lmidot;":"","&LongLeftArrow;":"","&LongLeftRightArrow;":"","&LongRightArrow;":"","&Longleftarrow;":"","&Longleftrightarrow;":"","&Longrightarrow;":"","&Lopf;":"","&LowerLeftArrow;":"","&LowerRightArrow;":"","&Lscr;":"","&Lsh;":"","&Lstrok;":"","&Lt;":"","&Map;":"","&Mcy;":"","&MediumSpace;":"","&Mellintrf;":"","&Mfr;":"","&MinusPlus;":"","&Mopf;":"","&Mscr;":"","&Mu;":"","&NJcy;":"","&Nacute;":"","&Ncaron;":"","&Ncedil;":"","&Ncy;":"","&NegativeMediumSpace;":"","&NegativeThickSpace;":"","&NegativeThinSpace;":"","&NegativeVeryThinSpace;":"","&NestedGreaterGreater;":"","&NestedLessLess;":"","&NewLine;":"\n","&Nfr;":"","&NoBreak;":"","&NonBreakingSpace;":"","&Nopf;":"","&Not;":"","&NotCongruent;":"","&NotCupCap;":"","&NotDoubleVerticalBar;":"","&NotElement;":"","&NotEqual;":"","&NotEqualTilde;":"","&NotExists;":"","&NotGreater;":"","&NotGreaterEqual;":"","&NotGreaterFullEqual;":"","&NotGreaterGreater;":"","&NotGreaterLess;":"","&NotGreaterSlantEqual;":"","&NotGreaterTilde;":"","&NotHumpDownHump;":"","&NotHumpEqual;":"","&NotLeftTriangle;":"","&NotLeftTriangleBar;":"","&NotLeftTriangleEqual;":"","&NotLess;":"","&NotLessEqual;":"","&NotLessGreater;":"","&NotLessLess;":"","&NotLessSlantEqual;":"","&NotLessTilde;":"","&NotNestedGreaterGreater;":"","&NotNestedLessLess;":"","&NotPrecedes;":"","&NotPrecedesEqual;":"","&NotPrecedesSlantEqual;":"","&NotReverseElement;":"","&NotRightTriangle;":"","&NotRightTriangleBar;":"","&NotRightTriangleEqual;":"","&NotSquareSubset;":"","&NotSquareSubsetEqual;":"","&NotSquareSuperset;":"","&NotSquareSupersetEqual;":"","&NotSubset;":"","&NotSubsetEqual;":"","&NotSucceeds;":"","&NotSucceedsEqual;":"","&NotSucceedsSlantEqual;":"","&NotSucceedsTilde;":"","&NotSuperset;":"","&NotSupersetEqual;":"","&NotTilde;":"","&NotTildeEqual;":"","&NotTildeFullEqual;":"","&NotTildeTilde;":"","&NotVerticalBar;":"","&Nscr;":"","&Ntilde":"","&Ntilde;":"","&Nu;":"","&OElig;":"","&Oacute":"","&Oacute;":"","&Ocirc":"","&Ocirc;":"","&Ocy;":"","&Odblac;":"","&Ofr;":"","&Ograve":"","&Ograve;":"","&Omacr;":"","&Omega;":"","&Omicron;":"","&Oopf;":"","&OpenCurlyDoubleQuote;":"","&OpenCurlyQuote;":"","&Or;":"","&Oscr;":"","&Oslash":"","&Oslash;":"","&Otilde":"","&Otilde;":"","&Otimes;":"","&Ouml":"","&Ouml;":"","&OverBar;":"","&OverBrace;":"","&OverBracket;":"","&OverParenthesis;":"","&PartialD;":"","&Pcy;":"","&Pfr;":"","&Phi;":"","&Pi;":"","&PlusMinus;":"","&Poincareplane;":"","&Popf;":"","&Pr;":"","&Precedes;":"","&PrecedesEqual;":"","&PrecedesSlantEqual;":"","&PrecedesTilde;":"","&Prime;":"","&Product;":"","&Proportion;":"","&Proportional;":"","&Pscr;":"","&Psi;":"","&QUOT":'"',"&QUOT;":'"',"&Qfr;":"","&Qopf;":"","&Qscr;":"","&RBarr;":"","&REG":"","&REG;":"","&Racute;":"","&Rang;":"","&Rarr;":"","&Rarrtl;":"","&Rcaron;":"","&Rcedil;":"","&Rcy;":"","&Re;":"","&ReverseElement;":"","&ReverseEquilibrium;":"","&ReverseUpEquilibrium;":"","&Rfr;":"","&Rho;":"","&RightAngleBracket;":"","&RightArrow;":"","&RightArrowBar;":"","&RightArrowLeftArrow;":"","&RightCeiling;":"","&RightDoubleBracket;":"","&RightDownTeeVector;":"","&RightDownVector;":"","&RightDownVectorBar;":"","&RightFloor;":"","&RightTee;":"","&RightTeeArrow;":"","&RightTeeVector;":"","&RightTriangle;":"","&RightTriangleBar;":"","&RightTriangleEqual;":"","&RightUpDownVector;":"","&RightUpTeeVector;":"","&RightUpVector;":"","&RightUpVectorBar;":"","&RightVector;":"","&RightVectorBar;":"","&Rightarrow;":"","&Ropf;":"","&RoundImplies;":"","&Rrightarrow;":"","&Rscr;":"","&Rsh;":"","&RuleDelayed;":"","&SHCHcy;":"","&SHcy;":"","&SOFTcy;":"","&Sacute;":"","&Sc;":"","&Scaron;":"","&Scedil;":"","&Scirc;":"","&Scy;":"","&Sfr;":"","&ShortDownArrow;":"","&ShortLeftArrow;":"","&ShortRightArrow;":"","&ShortUpArrow;":"","&Sigma;":"","&SmallCircle;":"","&Sopf;":"","&Sqrt;":"","&Square;":"","&SquareIntersection;":"","&SquareSubset;":"","&SquareSubsetEqual;":"","&SquareSuperset;":"","&SquareSupersetEqual;":"","&SquareUnion;":"","&Sscr;":"","&Star;":"","&Sub;":"","&Subset;":"","&SubsetEqual;":"","&Succeeds;":"","&SucceedsEqual;":"","&SucceedsSlantEqual;":"","&SucceedsTilde;":"","&SuchThat;":"","&Sum;":"","&Sup;":"","&Superset;":"","&SupersetEqual;":"","&Supset;":"","&THORN":"","&THORN;":"","&TRADE;":"","&TSHcy;":"","&TScy;":"","&Tab;":"\t","&Tau;":"","&Tcaron;":"","&Tcedil;":"","&Tcy;":"","&Tfr;":"","&Therefore;":"","&Theta;":"","&ThickSpace;":"","&ThinSpace;":"","&Tilde;":"","&TildeEqual;":"","&TildeFullEqual;":"","&TildeTilde;":"","&Topf;":"","&TripleDot;":"","&Tscr;":"","&Tstrok;":"","&Uacute":"","&Uacute;":"","&Uarr;":"","&Uarrocir;":"","&Ubrcy;":"","&Ubreve;":"","&Ucirc":"","&Ucirc;":"","&Ucy;":"","&Udblac;":"","&Ufr;":"","&Ugrave":"","&Ugrave;":"","&Umacr;":"","&UnderBar;":"_","&UnderBrace;":"","&UnderBracket;":"","&UnderParenthesis;":"","&Union;":"","&UnionPlus;":"","&Uogon;":"","&Uopf;":"","&UpArrow;":"","&UpArrowBar;":"","&UpArrowDownArrow;":"","&UpDownArrow;":"","&UpEquilibrium;":"","&UpTee;":"","&UpTeeArrow;":"","&Uparrow;":"","&Updownarrow;":"","&UpperLeftArrow;":"","&UpperRightArrow;":"","&Upsi;":"","&Upsilon;":"","&Uring;":"","&Uscr;":"","&Utilde;":"","&Uuml":"","&Uuml;":"","&VDash;":"","&Vbar;":"","&Vcy;":"","&Vdash;":"","&Vdashl;":"","&Vee;":"","&Verbar;":"","&Vert;":"","&VerticalBar;":"","&VerticalLine;":"|","&VerticalSeparator;":"","&VerticalTilde;":"","&VeryThinSpace;":"","&Vfr;":"","&Vopf;":"","&Vscr;":"","&Vvdash;":"","&Wcirc;":"","&Wedge;":"","&Wfr;":"","&Wopf;":"","&Wscr;":"","&Xfr;":"","&Xi;":"","&Xopf;":"","&Xscr;":"","&YAcy;":"","&YIcy;":"","&YUcy;":"","&Yacute":"","&Yacute;":"","&Ycirc;":"","&Ycy;":"","&Yfr;":"","&Yopf;":"","&Yscr;":"","&Yuml;":"","&ZHcy;":"","&Zacute;":"","&Zcaron;":"","&Zcy;":"","&Zdot;":"","&ZeroWidthSpace;":"","&Zeta;":"","&Zfr;":"","&Zopf;":"","&Zscr;":"","&aacute":"","&aacute;":"","&abreve;":"","&ac;":"","&acE;":"","&acd;":"","&acirc":"","&acirc;":"","&acute":"","&acute;":"","&acy;":"","&aelig":"","&aelig;":"","&af;":"","&afr;":"","&agrave":"","&agrave;":"","&alefsym;":"","&aleph;":"","&alpha;":"","&amacr;":"","&amalg;":"","&amp":"&","&amp;":"&","&and;":"","&andand;":"","&andd;":"","&andslope;":"","&andv;":"","&ang;":"","&ange;":"","&angle;":"","&angmsd;":"","&angmsdaa;":"","&angmsdab;":"","&angmsdac;":"","&angmsdad;":"","&angmsdae;":"","&angmsdaf;":"","&angmsdag;":"","&angmsdah;":"","&angrt;":"","&angrtvb;":"","&angrtvbd;":"","&angsph;":"","&angst;":"","&angzarr;":"","&aogon;":"","&aopf;":"","&ap;":"","&apE;":"","&apacir;":"","&ape;":"","&apid;":"","&apos;":"'","&approx;":"","&approxeq;":"","&aring":"","&aring;":"","&ascr;":"","&ast;":"*","&asymp;":"","&asympeq;":"","&atilde":"","&atilde;":"","&auml":"","&auml;":"","&awconint;":"","&awint;":"","&bNot;":"","&backcong;":"","&backepsilon;":"","&backprime;":"","&backsim;":"","&backsimeq;":"","&barvee;":"","&barwed;":"","&barwedge;":"","&bbrk;":"","&bbrktbrk;":"","&bcong;":"","&bcy;":"","&bdquo;":"","&becaus;":"","&because;":"","&bemptyv;":"","&bepsi;":"","&bernou;":"","&beta;":"","&beth;":"","&between;":"","&bfr;":"","&bigcap;":"","&bigcirc;":"","&bigcup;":"","&bigodot;":"","&bigoplus;":"","&bigotimes;":"","&bigsqcup;":"","&bigstar;":"","&bigtriangledown;":"","&bigtriangleup;":"","&biguplus;":"","&bigvee;":"","&bigwedge;":"","&bkarow;":"","&blacklozenge;":"","&blacksquare;":"","&blacktriangle;":"","&blacktriangledown;":"","&blacktriangleleft;":"","&blacktriangleright;":"","&blank;":"","&blk12;":"","&blk14;":"","&blk34;":"","&block;":"","&bne;":"=","&bnequiv;":"","&bnot;":"","&bopf;":"","&bot;":"","&bottom;":"","&bowtie;":"","&boxDL;":"","&boxDR;":"","&boxDl;":"","&boxDr;":"","&boxH;":"","&boxHD;":"","&boxHU;":"","&boxHd;":"","&boxHu;":"","&boxUL;":"","&boxUR;":"","&boxUl;":"","&boxUr;":"","&boxV;":"","&boxVH;":"","&boxVL;":"","&boxVR;":"","&boxVh;":"","&boxVl;":"","&boxVr;":"","&boxbox;":"","&boxdL;":"","&boxdR;":"","&boxdl;":"","&boxdr;":"","&boxh;":"","&boxhD;":"","&boxhU;":"","&boxhd;":"","&boxhu;":"","&boxminus;":"","&boxplus;":"","&boxtimes;":"","&boxuL;":"","&boxuR;":"","&boxul;":"","&boxur;":"","&boxv;":"","&boxvH;":"","&boxvL;":"","&boxvR;":"","&boxvh;":"","&boxvl;":"","&boxvr;":"","&bprime;":"","&breve;":"","&brvbar":"","&brvbar;":"","&bscr;":"","&bsemi;":"","&bsim;":"","&bsime;":"","&bsol;":"\\","&bsolb;":"","&bsolhsub;":"","&bull;":"","&bullet;":"","&bump;":"","&bumpE;":"","&bumpe;":"","&bumpeq;":"","&cacute;":"","&cap;":"","&capand;":"","&capbrcup;":"","&capcap;":"","&capcup;":"","&capdot;":"","&caps;":"","&caret;":"","&caron;":"","&ccaps;":"","&ccaron;":"","&ccedil":"","&ccedil;":"","&ccirc;":"","&ccups;":"","&ccupssm;":"","&cdot;":"","&cedil":"","&cedil;":"","&cemptyv;":"","&cent":"","&cent;":"","&centerdot;":"","&cfr;":"","&chcy;":"","&check;":"","&checkmark;":"","&chi;":"","&cir;":"","&cirE;":"","&circ;":"","&circeq;":"","&circlearrowleft;":"","&circlearrowright;":"","&circledR;":"","&circledS;":"","&circledast;":"","&circledcirc;":"","&circleddash;":"","&cire;":"","&cirfnint;":"","&cirmid;":"","&cirscir;":"","&clubs;":"","&clubsuit;":"","&colon;":":","&colone;":"","&coloneq;":"","&comma;":",","&commat;":"@","&comp;":"","&compfn;":"","&complement;":"","&complexes;":"","&cong;":"","&congdot;":"","&conint;":"","&copf;":"","&coprod;":"","&copy":"","&copy;":"","&copysr;":"","&crarr;":"","&cross;":"","&cscr;":"","&csub;":"","&csube;":"","&csup;":"","&csupe;":"","&ctdot;":"","&cudarrl;":"","&cudarrr;":"","&cuepr;":"","&cuesc;":"","&cularr;":"","&cularrp;":"","&cup;":"","&cupbrcap;":"","&cupcap;":"","&cupcup;":"","&cupdot;":"","&cupor;":"","&cups;":"","&curarr;":"","&curarrm;":"","&curlyeqprec;":"","&curlyeqsucc;":"","&curlyvee;":"","&curlywedge;":"","&curren":"","&curren;":"","&curvearrowleft;":"","&curvearrowright;":"","&cuvee;":"","&cuwed;":"","&cwconint;":"","&cwint;":"","&cylcty;":"","&dArr;":"","&dHar;":"","&dagger;":"","&daleth;":"","&darr;":"","&dash;":"","&dashv;":"","&dbkarow;":"","&dblac;":"","&dcaron;":"","&dcy;":"","&dd;":"","&ddagger;":"","&ddarr;":"","&ddotseq;":"","&deg":"","&deg;":"","&delta;":"","&demptyv;":"","&dfisht;":"","&dfr;":"","&dharl;":"","&dharr;":"","&diam;":"","&diamond;":"","&diamondsuit;":"","&diams;":"","&die;":"","&digamma;":"","&disin;":"","&div;":"","&divide":"","&divide;":"","&divideontimes;":"","&divonx;":"","&djcy;":"","&dlcorn;":"","&dlcrop;":"","&dollar;":"$","&dopf;":"","&dot;":"","&doteq;":"","&doteqdot;":"","&dotminus;":"","&dotplus;":"","&dotsquare;":"","&doublebarwedge;":"","&downarrow;":"","&downdownarrows;":"","&downharpoonleft;":"","&downharpoonright;":"","&drbkarow;":"","&drcorn;":"","&drcrop;":"","&dscr;":"","&dscy;":"","&dsol;":"","&dstrok;":"","&dtdot;":"","&dtri;":"","&dtrif;":"","&duarr;":"","&duhar;":"","&dwangle;":"","&dzcy;":"","&dzigrarr;":"","&eDDot;":"","&eDot;":"","&eacute":"","&eacute;":"","&easter;":"","&ecaron;":"","&ecir;":"","&ecirc":"","&ecirc;":"","&ecolon;":"","&ecy;":"","&edot;":"","&ee;":"","&efDot;":"","&efr;":"","&eg;":"","&egrave":"","&egrave;":"","&egs;":"","&egsdot;":"","&el;":"","&elinters;":"","&ell;":"","&els;":"","&elsdot;":"","&emacr;":"","&empty;":"","&emptyset;":"","&emptyv;":"","&emsp13;":"","&emsp14;":"","&emsp;":"","&eng;":"","&ensp;":"","&eogon;":"","&eopf;":"","&epar;":"","&eparsl;":"","&eplus;":"","&epsi;":"","&epsilon;":"","&epsiv;":"","&eqcirc;":"","&eqcolon;":"","&eqsim;":"","&eqslantgtr;":"","&eqslantless;":"","&equals;":"=","&equest;":"","&equiv;":"","&equivDD;":"","&eqvparsl;":"","&erDot;":"","&erarr;":"","&escr;":"","&esdot;":"","&esim;":"","&eta;":"","&eth":"","&eth;":"","&euml":"","&euml;":"","&euro;":"","&excl;":"!","&exist;":"","&expectation;":"","&exponentiale;":"","&fallingdotseq;":"","&fcy;":"","&female;":"","&ffilig;":"","&fflig;":"","&ffllig;":"","&ffr;":"","&filig;":"","&fjlig;":"fj","&flat;":"","&fllig;":"","&fltns;":"","&fnof;":"","&fopf;":"","&forall;":"","&fork;":"","&forkv;":"","&fpartint;":"","&frac12":"","&frac12;":"","&frac13;":"","&frac14":"","&frac14;":"","&frac15;":"","&frac16;":"","&frac18;":"","&frac23;":"","&frac25;":"","&frac34":"","&frac34;":"","&frac35;":"","&frac38;":"","&frac45;":"","&frac56;":"","&frac58;":"","&frac78;":"","&frasl;":"","&frown;":"","&fscr;":"","&gE;":"","&gEl;":"","&gacute;":"","&gamma;":"","&gammad;":"","&gap;":"","&gbreve;":"","&gcirc;":"","&gcy;":"","&gdot;":"","&ge;":"","&gel;":"","&geq;":"","&geqq;":"","&geqslant;":"","&ges;":"","&gescc;":"","&gesdot;":"","&gesdoto;":"","&gesdotol;":"","&gesl;":"","&gesles;":"","&gfr;":"","&gg;":"","&ggg;":"","&gimel;":"","&gjcy;":"","&gl;":"","&glE;":"","&gla;":"","&glj;":"","&gnE;":"","&gnap;":"","&gnapprox;":"","&gne;":"","&gneq;":"","&gneqq;":"","&gnsim;":"","&gopf;":"","&grave;":"`","&gscr;":"","&gsim;":"","&gsime;":"","&gsiml;":"","&gt":">","&gt;":">","&gtcc;":"","&gtcir;":"","&gtdot;":"","&gtlPar;":"","&gtquest;":"","&gtrapprox;":"","&gtrarr;":"","&gtrdot;":"","&gtreqless;":"","&gtreqqless;":"","&gtrless;":"","&gtrsim;":"","&gvertneqq;":"","&gvnE;":"","&hArr;":"","&hairsp;":"","&half;":"","&hamilt;":"","&hardcy;":"","&harr;":"","&harrcir;":"","&harrw;":"","&hbar;":"","&hcirc;":"","&hearts;":"","&heartsuit;":"","&hellip;":"","&hercon;":"","&hfr;":"","&hksearow;":"","&hkswarow;":"","&hoarr;":"","&homtht;":"","&hookleftarrow;":"","&hookrightarrow;":"","&hopf;":"","&horbar;":"","&hscr;":"","&hslash;":"","&hstrok;":"","&hybull;":"","&hyphen;":"","&iacute":"","&iacute;":"","&ic;":"","&icirc":"","&icirc;":"","&icy;":"","&iecy;":"","&iexcl":"","&iexcl;":"","&iff;":"","&ifr;":"","&igrave":"","&igrave;":"","&ii;":"","&iiiint;":"","&iiint;":"","&iinfin;":"","&iiota;":"","&ijlig;":"","&imacr;":"","&image;":"","&imagline;":"","&imagpart;":"","&imath;":"","&imof;":"","&imped;":"","&in;":"","&incare;":"","&infin;":"","&infintie;":"","&inodot;":"","&int;":"","&intcal;":"","&integers;":"","&intercal;":"","&intlarhk;":"","&intprod;":"","&iocy;":"","&iogon;":"","&iopf;":"","&iota;":"","&iprod;":"","&iquest":"","&iquest;":"","&iscr;":"","&isin;":"","&isinE;":"","&isindot;":"","&isins;":"","&isinsv;":"","&isinv;":"","&it;":"","&itilde;":"","&iukcy;":"","&iuml":"","&iuml;":"","&jcirc;":"","&jcy;":"","&jfr;":"","&jmath;":"","&jopf;":"","&jscr;":"","&jsercy;":"","&jukcy;":"","&kappa;":"","&kappav;":"","&kcedil;":"","&kcy;":"","&kfr;":"","&kgreen;":"","&khcy;":"","&kjcy;":"","&kopf;":"","&kscr;":"","&lAarr;":"","&lArr;":"","&lAtail;":"","&lBarr;":"","&lE;":"","&lEg;":"","&lHar;":"","&lacute;":"","&laemptyv;":"","&lagran;":"","&lambda;":"","&lang;":"","&langd;":"","&langle;":"","&lap;":"","&laquo":"","&laquo;":"","&larr;":"","&larrb;":"","&larrbfs;":"","&larrfs;":"","&larrhk;":"","&larrlp;":"","&larrpl;":"","&larrsim;":"","&larrtl;":"","&lat;":"","&latail;":"","&late;":"","&lates;":"","&lbarr;":"","&lbbrk;":"","&lbrace;":"{","&lbrack;":"[","&lbrke;":"","&lbrksld;":"","&lbrkslu;":"","&lcaron;":"","&lcedil;":"","&lceil;":"","&lcub;":"{","&lcy;":"","&ldca;":"","&ldquo;":"","&ldquor;":"","&ldrdhar;":"","&ldrushar;":"","&ldsh;":"","&le;":"","&leftarrow;":"","&leftarrowtail;":"","&leftharpoondown;":"","&leftharpoonup;":"","&leftleftarrows;":"","&leftrightarrow;":"","&leftrightarrows;":"","&leftrightharpoons;":"","&leftrightsquigarrow;":"","&leftthreetimes;":"","&leg;":"","&leq;":"","&leqq;":"","&leqslant;":"","&les;":"","&lescc;":"","&lesdot;":"","&lesdoto;":"","&lesdotor;":"","&lesg;":"","&lesges;":"","&lessapprox;":"","&lessdot;":"","&lesseqgtr;":"","&lesseqqgtr;":"","&lessgtr;":"","&lesssim;":"","&lfisht;":"","&lfloor;":"","&lfr;":"","&lg;":"","&lgE;":"","&lhard;":"","&lharu;":"","&lharul;":"","&lhblk;":"","&ljcy;":"","&ll;":"","&llarr;":"","&llcorner;":"","&llhard;":"","&lltri;":"","&lmidot;":"","&lmoust;":"","&lmoustache;":"","&lnE;":"","&lnap;":"","&lnapprox;":"","&lne;":"","&lneq;":"","&lneqq;":"","&lnsim;":"","&loang;":"","&loarr;":"","&lobrk;":"","&longleftarrow;":"","&longleftrightarrow;":"","&longmapsto;":"","&longrightarrow;":"","&looparrowleft;":"","&looparrowright;":"","&lopar;":"","&lopf;":"","&loplus;":"","&lotimes;":"","&lowast;":"","&lowbar;":"_","&loz;":"","&lozenge;":"","&lozf;":"","&lpar;":"(","&lparlt;":"","&lrarr;":"","&lrcorner;":"","&lrhar;":"","&lrhard;":"","&lrm;":"","&lrtri;":"","&lsaquo;":"","&lscr;":"","&lsh;":"","&lsim;":"","&lsime;":"","&lsimg;":"","&lsqb;":"[","&lsquo;":"","&lsquor;":"","&lstrok;":"","&lt":"<","&lt;":"<","&ltcc;":"","&ltcir;":"","&ltdot;":"","&lthree;":"","&ltimes;":"","&ltlarr;":"","&ltquest;":"","&ltrPar;":"","&ltri;":"","&ltrie;":"","&ltrif;":"","&lurdshar;":"","&luruhar;":"","&lvertneqq;":"","&lvnE;":"","&mDDot;":"","&macr":"","&macr;":"","&male;":"","&malt;":"","&maltese;":"","&map;":"","&mapsto;":"","&mapstodown;":"","&mapstoleft;":"","&mapstoup;":"","&marker;":"","&mcomma;":"","&mcy;":"","&mdash;":"","&measuredangle;":"","&mfr;":"","&mho;":"","&micro":"","&micro;":"","&mid;":"","&midast;":"*","&midcir;":"","&middot":"","&middot;":"","&minus;":"","&minusb;":"","&minusd;":"","&minusdu;":"","&mlcp;":"","&mldr;":"","&mnplus;":"","&models;":"","&mopf;":"","&mp;":"","&mscr;":"","&mstpos;":"","&mu;":"","&multimap;":"","&mumap;":"","&nGg;":"","&nGt;":"","&nGtv;":"","&nLeftarrow;":"","&nLeftrightarrow;":"","&nLl;":"","&nLt;":"","&nLtv;":"","&nRightarrow;":"","&nVDash;":"","&nVdash;":"","&nabla;":"","&nacute;":"","&nang;":"","&nap;":"","&napE;":"","&napid;":"","&napos;":"","&napprox;":"","&natur;":"","&natural;":"","&naturals;":"","&nbsp":"","&nbsp;":"","&nbump;":"","&nbumpe;":"","&ncap;":"","&ncaron;":"","&ncedil;":"","&ncong;":"","&ncongdot;":"","&ncup;":"","&ncy;":"","&ndash;":"","&ne;":"","&neArr;":"","&nearhk;":"","&nearr;":"","&nearrow;":"","&nedot;":"","&nequiv;":"","&nesear;":"","&nesim;":"","&nexist;":"","&nexists;":"","&nfr;":"","&ngE;":"","&nge;":"","&ngeq;":"","&ngeqq;":"","&ngeqslant;":"","&nges;":"","&ngsim;":"","&ngt;":"","&ngtr;":"","&nhArr;":"","&nharr;":"","&nhpar;":"","&ni;":"","&nis;":"","&nisd;":"","&niv;":"","&njcy;":"","&nlArr;":"","&nlE;":"","&nlarr;":"","&nldr;":"","&nle;":"","&nleftarrow;":"","&nleftrightarrow;":"","&nleq;":"","&nleqq;":"","&nleqslant;":"","&nles;":"","&nless;":"","&nlsim;":"","&nlt;":"","&nltri;":"","&nltrie;":"","&nmid;":"","&nopf;":"","&not":"","&not;":"","&notin;":"","&notinE;":"","&notindot;":"","&notinva;":"","&notinvb;":"","&notinvc;":"","&notni;":"","&notniva;":"","&notnivb;":"","&notnivc;":"","&npar;":"","&nparallel;":"","&nparsl;":"","&npart;":"","&npolint;":"","&npr;":"","&nprcue;":"","&npre;":"","&nprec;":"","&npreceq;":"","&nrArr;":"","&nrarr;":"","&nrarrc;":"","&nrarrw;":"","&nrightarrow;":"","&nrtri;":"","&nrtrie;":"","&nsc;":"","&nsccue;":"","&nsce;":"","&nscr;":"","&nshortmid;":"","&nshortparallel;":"","&nsim;":"","&nsime;":"","&nsimeq;":"","&nsmid;":"","&nspar;":"","&nsqsube;":"","&nsqsupe;":"","&nsub;":"","&nsubE;":"","&nsube;":"","&nsubset;":"","&nsubseteq;":"","&nsubseteqq;":"","&nsucc;":"","&nsucceq;":"","&nsup;":"","&nsupE;":"","&nsupe;":"","&nsupset;":"","&nsupseteq;":"","&nsupseteqq;":"","&ntgl;":"","&ntilde":"","&ntilde;":"","&ntlg;":"","&ntriangleleft;":"","&ntrianglelefteq;":"","&ntriangleright;":"","&ntrianglerighteq;":"","&nu;":"","&num;":"#","&numero;":"","&numsp;":"","&nvDash;":"","&nvHarr;":"","&nvap;":"","&nvdash;":"","&nvge;":"","&nvgt;":">","&nvinfin;":"","&nvlArr;":"","&nvle;":"","&nvlt;":"<","&nvltrie;":"","&nvrArr;":"","&nvrtrie;":"","&nvsim;":"","&nwArr;":"","&nwarhk;":"","&nwarr;":"","&nwarrow;":"","&nwnear;":"","&oS;":"","&oacute":"","&oacute;":"","&oast;":"","&ocir;":"","&ocirc":"","&ocirc;":"","&ocy;":"","&odash;":"","&odblac;":"","&odiv;":"","&odot;":"","&odsold;":"","&oelig;":"","&ofcir;":"","&ofr;":"","&ogon;":"","&ograve":"","&ograve;":"","&ogt;":"","&ohbar;":"","&ohm;":"","&oint;":"","&olarr;":"","&olcir;":"","&olcross;":"","&oline;":"","&olt;":"","&omacr;":"","&omega;":"","&omicron;":"","&omid;":"","&ominus;":"","&oopf;":"","&opar;":"","&operp;":"","&oplus;":"","&or;":"","&orarr;":"","&ord;":"","&order;":"","&orderof;":"","&ordf":"","&ordf;":"","&ordm":"","&ordm;":"","&origof;":"","&oror;":"","&orslope;":"","&orv;":"","&oscr;":"","&oslash":"","&oslash;":"","&osol;":"","&otilde":"","&otilde;":"","&otimes;":"","&otimesas;":"","&ouml":"","&ouml;":"","&ovbar;":"","&par;":"","&para":"","&para;":"","&parallel;":"","&parsim;":"","&parsl;":"","&part;":"","&pcy;":"","&percnt;":"%","&period;":".","&permil;":"","&perp;":"","&pertenk;":"","&pfr;":"","&phi;":"","&phiv;":"","&phmmat;":"","&phone;":"","&pi;":"","&pitchfork;":"","&piv;":"","&planck;":"","&planckh;":"","&plankv;":"","&plus;":"+","&plusacir;":"","&plusb;":"","&pluscir;":"","&plusdo;":"","&plusdu;":"","&pluse;":"","&plusmn":"","&plusmn;":"","&plussim;":"","&plustwo;":"","&pm;":"","&pointint;":"","&popf;":"","&pound":"","&pound;":"","&pr;":"","&prE;":"","&prap;":"","&prcue;":"","&pre;":"","&prec;":"","&precapprox;":"","&preccurlyeq;":"","&preceq;":"","&precnapprox;":"","&precneqq;":"","&precnsim;":"","&precsim;":"","&prime;":"","&primes;":"","&prnE;":"","&prnap;":"","&prnsim;":"","&prod;":"","&profalar;":"","&profline;":"","&profsurf;":"","&prop;":"","&propto;":"","&prsim;":"","&prurel;":"","&pscr;":"","&psi;":"","&puncsp;":"","&qfr;":"","&qint;":"","&qopf;":"","&qprime;":"","&qscr;":"","&quaternions;":"","&quatint;":"","&quest;":"?","&questeq;":"","&quot":'"',"&quot;":'"',"&rAarr;":"","&rArr;":"","&rAtail;":"","&rBarr;":"","&rHar;":"","&race;":"","&racute;":"","&radic;":"","&raemptyv;":"","&rang;":"","&rangd;":"","&range;":"","&rangle;":"","&raquo":"","&raquo;":"","&rarr;":"","&rarrap;":"","&rarrb;":"","&rarrbfs;":"","&rarrc;":"","&rarrfs;":"","&rarrhk;":"","&rarrlp;":"","&rarrpl;":"","&rarrsim;":"","&rarrtl;":"","&rarrw;":"","&ratail;":"","&ratio;":"","&rationals;":"","&rbarr;":"","&rbbrk;":"","&rbrace;":"}","&rbrack;":"]","&rbrke;":"","&rbrksld;":"","&rbrkslu;":"","&rcaron;":"","&rcedil;":"","&rceil;":"","&rcub;":"}","&rcy;":"","&rdca;":"","&rdldhar;":"","&rdquo;":"","&rdquor;":"","&rdsh;":"","&real;":"","&realine;":"","&realpart;":"","&reals;":"","&rect;":"","&reg":"","&reg;":"","&rfisht;":"","&rfloor;":"","&rfr;":"","&rhard;":"","&rharu;":"","&rharul;":"","&rho;":"","&rhov;":"","&rightarrow;":"","&rightarrowtail;":"","&rightharpoondown;":"","&rightharpoonup;":"","&rightleftarrows;":"","&rightleftharpoons;":"","&rightrightarrows;":"","&rightsquigarrow;":"","&rightthreetimes;":"","&ring;":"","&risingdotseq;":"","&rlarr;":"","&rlhar;":"","&rlm;":"","&rmoust;":"","&rmoustache;":"","&rnmid;":"","&roang;":"","&roarr;":"","&robrk;":"","&ropar;":"","&ropf;":"","&roplus;":"","&rotimes;":"","&rpar;":")","&rpargt;":"","&rppolint;":"","&rrarr;":"","&rsaquo;":"","&rscr;":"","&rsh;":"","&rsqb;":"]","&rsquo;":"","&rsquor;":"","&rthree;":"","&rtimes;":"","&rtri;":"","&rtrie;":"","&rtrif;":"","&rtriltri;":"","&ruluhar;":"","&rx;":"","&sacute;":"","&sbquo;":"","&sc;":"","&scE;":"","&scap;":"","&scaron;":"","&sccue;":"","&sce;":"","&scedil;":"","&scirc;":"","&scnE;":"","&scnap;":"","&scnsim;":"","&scpolint;":"","&scsim;":"","&scy;":"","&sdot;":"","&sdotb;":"","&sdote;":"","&seArr;":"","&searhk;":"","&searr;":"","&searrow;":"","&sect":"","&sect;":"","&semi;":";","&seswar;":"","&setminus;":"","&setmn;":"","&sext;":"","&sfr;":"","&sfrown;":"","&sharp;":"","&shchcy;":"","&shcy;":"","&shortmid;":"","&shortparallel;":"","&shy":"","&shy;":"","&sigma;":"","&sigmaf;":"","&sigmav;":"","&sim;":"","&simdot;":"","&sime;":"","&simeq;":"","&simg;":"","&simgE;":"","&siml;":"","&simlE;":"","&simne;":"","&simplus;":"","&simrarr;":"","&slarr;":"","&smallsetminus;":"","&smashp;":"","&smeparsl;":"","&smid;":"","&smile;":"","&smt;":"","&smte;":"","&smtes;":"","&softcy;":"","&sol;":"/","&solb;":"","&solbar;":"","&sopf;":"","&spades;":"","&spadesuit;":"","&spar;":"","&sqcap;":"","&sqcaps;":"","&sqcup;":"","&sqcups;":"","&sqsub;":"","&sqsube;":"","&sqsubset;":"","&sqsubseteq;":"","&sqsup;":"","&sqsupe;":"","&sqsupset;":"","&sqsupseteq;":"","&squ;":"","&square;":"","&squarf;":"","&squf;":"","&srarr;":"","&sscr;":"","&ssetmn;":"","&ssmile;":"","&sstarf;":"","&star;":"","&starf;":"","&straightepsilon;":"","&straightphi;":"","&strns;":"","&sub;":"","&subE;":"","&subdot;":"","&sube;":"","&subedot;":"","&submult;":"","&subnE;":"","&subne;":"","&subplus;":"","&subrarr;":"","&subset;":"","&subseteq;":"","&subseteqq;":"","&subsetneq;":"","&subsetneqq;":"","&subsim;":"","&subsub;":"","&subsup;":"","&succ;":"","&succapprox;":"","&succcurlyeq;":"","&succeq;":"","&succnapprox;":"","&succneqq;":"","&succnsim;":"","&succsim;":"","&sum;":"","&sung;":"","&sup1":"","&sup1;":"","&sup2":"","&sup2;":"","&sup3":"","&sup3;":"","&sup;":"","&supE;":"","&supdot;":"","&supdsub;":"","&supe;":"","&supedot;":"","&suphsol;":"","&suphsub;":"","&suplarr;":"","&supmult;":"","&supnE;":"","&supne;":"","&supplus;":"","&supset;":"","&supseteq;":"","&supseteqq;":"","&supsetneq;":"","&supsetneqq;":"","&supsim;":"","&supsub;":"","&supsup;":"","&swArr;":"","&swarhk;":"","&swarr;":"","&swarrow;":"","&swnwar;":"","&szlig":"","&szlig;":"","&target;":"","&tau;":"","&tbrk;":"","&tcaron;":"","&tcedil;":"","&tcy;":"","&tdot;":"","&telrec;":"","&tfr;":"","&there4;":"","&therefore;":"","&theta;":"","&thetasym;":"","&thetav;":"","&thickapprox;":"","&thicksim;":"","&thinsp;":"","&thkap;":"","&thksim;":"","&thorn":"","&thorn;":"","&tilde;":"","&times":"","&times;":"","&timesb;":"","&timesbar;":"","&timesd;":"","&tint;":"","&toea;":"","&top;":"","&topbot;":"","&topcir;":"","&topf;":"","&topfork;":"","&tosa;":"","&tprime;":"","&trade;":"","&triangle;":"","&triangledown;":"","&triangleleft;":"","&trianglelefteq;":"","&triangleq;":"","&triangleright;":"","&trianglerighteq;":"","&tridot;":"","&trie;":"","&triminus;":"","&triplus;":"","&trisb;":"","&tritime;":"","&trpezium;":"","&tscr;":"","&tscy;":"","&tshcy;":"","&tstrok;":"","&twixt;":"","&twoheadleftarrow;":"","&twoheadrightarrow;":"","&uArr;":"","&uHar;":"","&uacute":"","&uacute;":"","&uarr;":"","&ubrcy;":"","&ubreve;":"","&ucirc":"","&ucirc;":"","&ucy;":"","&udarr;":"","&udblac;":"","&udhar;":"","&ufisht;":"","&ufr;":"","&ugrave":"","&ugrave;":"","&uharl;":"","&uharr;":"","&uhblk;":"","&ulcorn;":"","&ulcorner;":"","&ulcrop;":"","&ultri;":"","&umacr;":"","&uml":"","&uml;":"","&uogon;":"","&uopf;":"","&uparrow;":"","&updownarrow;":"","&upharpoonleft;":"","&upharpoonright;":"","&uplus;":"","&upsi;":"","&upsih;":"","&upsilon;":"","&upuparrows;":"","&urcorn;":"","&urcorner;":"","&urcrop;":"","&uring;":"","&urtri;":"","&uscr;":"","&utdot;":"","&utilde;":"","&utri;":"","&utrif;":"","&uuarr;":"","&uuml":"","&uuml;":"","&uwangle;":"","&vArr;":"","&vBar;":"","&vBarv;":"","&vDash;":"","&vangrt;":"","&varepsilon;":"","&varkappa;":"","&varnothing;":"","&varphi;":"","&varpi;":"","&varpropto;":"","&varr;":"","&varrho;":"","&varsigma;":"","&varsubsetneq;":"","&varsubsetneqq;":"","&varsupsetneq;":"","&varsupsetneqq;":"","&vartheta;":"","&vartriangleleft;":"","&vartriangleright;":"","&vcy;":"","&vdash;":"","&vee;":"","&veebar;":"","&veeeq;":"","&vellip;":"","&verbar;":"|","&vert;":"|","&vfr;":"","&vltri;":"","&vnsub;":"","&vnsup;":"","&vopf;":"","&vprop;":"","&vrtri;":"","&vscr;":"","&vsubnE;":"","&vsubne;":"","&vsupnE;":"","&vsupne;":"","&vzigzag;":"","&wcirc;":"","&wedbar;":"","&wedge;":"","&wedgeq;":"","&weierp;":"","&wfr;":"","&wopf;":"","&wp;":"","&wr;":"","&wreath;":"","&wscr;":"","&xcap;":"","&xcirc;":"","&xcup;":"","&xdtri;":"","&xfr;":"","&xhArr;":"","&xharr;":"","&xi;":"","&xlArr;":"","&xlarr;":"","&xmap;":"","&xnis;":"","&xodot;":"","&xopf;":"","&xoplus;":"","&xotime;":"","&xrArr;":"","&xrarr;":"","&xscr;":"","&xsqcup;":"","&xuplus;":"","&xutri;":"","&xvee;":"","&xwedge;":"","&yacute":"","&yacute;":"","&yacy;":"","&ycirc;":"","&ycy;":"","&yen":"","&yen;":"","&yfr;":"","&yicy;":"","&yopf;":"","&yscr;":"","&yucy;":"","&yuml":"","&yuml;":"","&zacute;":"","&zcaron;":"","&zcy;":"","&zdot;":"","&zeetrf;":"","&zeta;":"","&zfr;":"","&zhcy;":"","&zigrarr;":"","&zopf;":"","&zscr;":"","&zwj;":"","&zwnj;":""};function r(e){return e.replace(/&(#\d+|#x[a-f0-9]+|[a-z]+\d*);?/gi,((e,r)=>{if(typeof t[e]==="string"){return t[e]}if(r.charAt(0)!=="#"||e.charAt(e.length-1)!==";"){return e}let i;if(r.charAt(1)==="x"){i=parseInt(r.substr(2),16)}else{i=parseInt(r.substr(1),10)}var s="";if(i>=55296&&i<=57343||i>1114111){return""}if(i>65535){i-=65536;s+=String.fromCharCode(i>>>10&1023|55296);i=56320|i&1023}s+=String.fromCharCode(i);return s}))}function i(e){return e.trim().replace(/[<>"'?&]/g,(e=>{let t=e.charCodeAt(0).toString(16);if(t.length<2){t="0"+t}return"&#x"+t.toUpperCase()+";"}))}function s(e){let t=i(e).replace(/\n/g,"<br />");return"<div>"+t+"</div>"}function a(e){e=e.replace(/\r?\n/g,"&#1;").replace(/<\!\-\-.*?\-\->/gi," ").replace(/<br\b[^>]*>/gi,"\n").replace(/<\/?(p|div|table|tr|td|th)\b[^>]*>/gi,"\n\n").replace(/<script\b[^>]*>.*?<\/script\b[^>]*>/gi," ").replace(/^.*<body\b[^>]*>/i,"").replace(/^.*<\/head\b[^>]*>/i,"").replace(/^.*<\!doctype\b[^>]*>/i,"").replace(/<\/body\b[^>]*>.*$/i,"").replace(/<\/html\b[^>]*>.*$/i,"").replace(/<a\b[^>]*href\s*=\s*["']?([^\s"']+)[^>]*>/gi," ($1) ").replace(/<\/?(span|em|i|strong|b|u|a)\b[^>]*>/gi,"").replace(/<li\b[^>]*>[\n\u0001\s]*/gi,"* ").replace(/<hr\b[^>]*>/g,"\n-------------\n").replace(/<[^>]*>/g," ").replace(/\u0001/g,"\n").replace(/[ \t]+/g," ").replace(/^\s+$/gm,"").replace(/\n\n+/g,"\n\n").replace(/^\n+/,"\n").replace(/\n+$/,"\n");e=r(e);return e}function n(e){return[].concat(e.name||[]).concat(e.name?`<${e.address}>`:e.address).join(" ")}function o(e){let t=[];let r=(e,i)=>{if(i){t.push(", ")}if(e.group){let i=`${e.name}:`;let s=`;`;t.push(i);e.group.forEach(r);t.push(s)}else{t.push(n(e))}};e.forEach(r);return t.join("")}function l(e){return`<a href="mailto:${i(e.address)}" class="postal-email-address">${i(e.name||`<${e.address}>`)}</a>`}function c(e){let t=[];let r=(e,s)=>{if(s){t.push('<span class="postal-email-address-separator">, </span>')}if(e.group){let s=`<span class="postal-email-address-group">${i(e.name)}:</span>`;let a=`<span class="postal-email-address-group">;</span>`;t.push(s);e.group.forEach(r);t.push(a)}else{t.push(l(e))}};e.forEach(r);return t.join(" ")}function u(e,t,r){e=(e||"").toString();t=t||76;let i=0,s=e.length,a="",n,o;while(i<s){n=e.substr(i,t);if(n.length<t){a+=n;break}if(o=n.match(/^[^\n\r]*(\r?\n|\r)/)){n=o[0];a+=n;i+=n.length;continue}else if((o=n.match(/(\s+)[^\s]*$/))&&o[0].length-(r?(o[1]||"").length:0)<n.length){n=n.substr(0,n.length-(o[0].length-(r?(o[1]||"").length:0)))}else if(o=e.substr(i+n.length).match(/^[^\s]+(\s*)/)){n=n+o[0].substr(0,o[0].length-(!r?(o[1]||"").length:0))}a+=n;i+=n.length;if(i<s){a+="\r\n"}}return a}function h(e){let t=[];if(e.from){t.push({key:"From",val:n(e.from)})}if(e.subject){t.push({key:"Subject",val:e.subject})}if(e.date){let r={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:false};let i=typeof Intl==="undefined"?e.date:new Intl.DateTimeFormat("default",r).format(new Date(e.date));t.push({key:"Date",val:i})}if(e.to&&e.to.length){t.push({key:"To",val:o(e.to)})}if(e.cc&&e.cc.length){t.push({key:"Cc",val:o(e.cc)})}if(e.bcc&&e.bcc.length){t.push({key:"Bcc",val:o(e.bcc)})}let r=t.map((e=>e.key.length)).reduce(((e,t)=>t>e?t:e),0);t=t.flatMap((e=>{let t=r-e.key.length;let i=`${e.key}: ${" ".repeat(t)}`;let s=`${" ".repeat(e.key.length+1)} ${" ".repeat(t)}`;let a=u(e.val,80,true).split(/\r?\n/).map((e=>e.trim()));return a.map(((e,t)=>`${t?s:i}${e}`))}));console.log(t);console.log(t.map((e=>e.length)));let i=t.map((e=>e.length)).reduce(((e,t)=>t>e?t:e),0);console.log(i);let s="-".repeat(i);let a=`\n${s}\n${t.join("\n")}\n${s}\n`;return a}function d(e){let t=[];if(e.from){t.push(`<div class="postal-email-header-key">From</div><div class="postal-email-header-value">${l(e.from)}</div>`)}if(e.subject){t.push(`<div class="postal-email-header-key">Subject</div><div class="postal-email-header-value postal-email-header-subject">${i(e.subject)}</div>`)}if(e.date){let r={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:false};let s=typeof Intl==="undefined"?e.date:new Intl.DateTimeFormat("default",r).format(new Date(e.date));t.push(`<div class="postal-email-header-key">Date</div><div class="postal-email-header-value postal-email-header-date" data-date="${i(e.date)}">${i(s)}</div>`)}if(e.to&&e.to.length){t.push(`<div class="postal-email-header-key">To</div><div class="postal-email-header-value">${c(e.to)}</div>`)}if(e.cc&&e.cc.length){t.push(`<div class="postal-email-header-key">Cc</div><div class="postal-email-header-value">${c(e.cc)}</div>`)}if(e.bcc&&e.bcc.length){t.push(`<div class="postal-email-header-key">Bcc</div><div class="postal-email-header-value">${c(e.bcc)}</div>`)}let r=`<div class="postal-email-header">${t.length?'<div class="postal-email-header-row">':""}${t.join('</div>\n<div class="postal-email-header-row">')}${t.length?"</div>":""}</div>`;return r}function p(e){let t;let r=false;let i="text";let s;let a=[];let n={address:[],comment:[],group:[],text:[]};let o;let l;for(o=0,l=e.length;o<l;o++){t=e[o];if(t.type==="operator"){switch(t.value){case"<":i="address";break;case"(":i="comment";break;case":":i="group";r=true;break;default:i="text"}}else if(t.value){if(i==="address"){t.value=t.value.replace(/^[^<]*<\s*/,"")}n[i].push(t.value)}}if(!n.text.length&&n.comment.length){n.text=n.comment;n.comment=[]}if(r){n.text=n.text.join(" ");a.push({name:x(n.text||s&&s.name),group:n.group.length?m(n.group.join(",")):[]})}else{if(!n.address.length&&n.text.length){for(o=n.text.length-1;o>=0;o--){if(n.text[o].match(/^[^@\s]+@[^@\s]+$/)){n.address=n.text.splice(o,1);break}}let e=function(e){if(!n.address.length){n.address=[e.trim()];return" "}else{return e}};if(!n.address.length){for(o=n.text.length-1;o>=0;o--){n.text[o]=n.text[o].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,e).trim();if(n.address.length){break}}}}if(!n.text.length&&n.comment.length){n.text=n.comment;n.comment=[]}if(n.address.length>1){n.text=n.text.concat(n.address.splice(1))}n.text=n.text.join(" ");n.address=n.address.join(" ");if(!n.address&&r){return[]}else{s={address:n.address||n.text||"",name:x(n.text||n.address||"")};if(s.address===s.name){if((s.address||"").match(/@/)){s.name=""}else{s.address=""}}a.push(s)}}return a}class f{constructor(e){this.str=(e||"").toString();this.operatorCurrent="";this.operatorExpecting="";this.node=null;this.escaped=false;this.list=[];this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let e,t=[];for(let t=0,r=this.str.length;t<r;t++){e=this.str.charAt(t);this.checkChar(e)}this.list.forEach((e=>{e.value=(e.value||"").toString().trim();if(e.value){t.push(e)}}));return t}checkChar(e){if(this.escaped){}else if(e===this.operatorExpecting){this.node={type:"operator",value:e};this.list.push(this.node);this.node=null;this.operatorExpecting="";this.escaped=false;return}else if(!this.operatorExpecting&&e in this.operators){this.node={type:"operator",value:e};this.list.push(this.node);this.node=null;this.operatorExpecting=this.operators[e];this.escaped=false;return}else if(['"',"'"].includes(this.operatorExpecting)&&e==="\\"){this.escaped=true;return}if(!this.node){this.node={type:"text",value:""};this.list.push(this.node)}if(e==="\n"){e=" "}if(e.charCodeAt(0)>=33||[" ","\t"].includes(e)){this.node.value+=e}this.escaped=false}}function m(e,t){t=t||{};let r=new f(e);let i=r.tokenize();let s=[];let a=[];let n=[];i.forEach((e=>{if(e.type==="operator"&&(e.value===","||e.value===";")){if(a.length){s.push(a)}a=[]}else{a.push(e)}}));if(a.length){s.push(a)}s.forEach((e=>{e=p(e);if(e.length){n=n.concat(e)}}));if(t.flatten){let e=[];let t=r=>{r.forEach((r=>{if(r.group){return t(r.group)}else{e.push(r)}}))};t(n);return e}return n}const y=new TextEncoder;const g=new Map;const b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const _=new Uint8Array(256);for(var D=0;D<b.length;D++){_[b.charCodeAt(D)]=D}function T(e){let t=Math.ceil(e.length/4)*3;const r=e.length;let i=0;if(e.length%4===3){t--}else if(e.length%4===2){t-=2}else if(e[e.length-1]==="="){t--;if(e[e.length-2]==="="){t--}}const s=new ArrayBuffer(t);const a=new Uint8Array(s);for(let t=0;t<r;t+=4){let r=_[e.charCodeAt(t)];let s=_[e.charCodeAt(t+1)];let n=_[e.charCodeAt(t+2)];let o=_[e.charCodeAt(t+3)];a[i++]=r<<2|s>>4;a[i++]=(s&15)<<4|n>>2;a[i++]=(n&3)<<6|o&63}return s}function w(e){e=e||"utf8";if(g.has(e)){return g.get(e)}let t;try{t=new TextDecoder(e)}catch(t){if(e==="utf8"){throw t}return w()}g.set(e,t);return t}async function v(e){if("arrayBuffer"in e){return await e.arrayBuffer()}const t=new FileReader;return new Promise(((r,i)=>{t.onload=function(e){r(e.target.result)};t.onerror=function(e){i(t.error)};t.readAsArrayBuffer(e)}))}function A(e){if(e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70){return String.fromCharCode(e)}return false}function Y(e,t,r){let i=e.indexOf("*");if(i>=0){e=e.substr(0,i)}t=t.toUpperCase();let s;if(t==="Q"){r=r.replace(/=\s+([0-9a-fA-F])/g,"=$1").replace(/[_\s]/g," ");let e=y.encode(r);let t=[];for(let r=0,i=e.length;r<i;r++){let s=e[r];if(r<=i-2&&s===61){let i=A(e[r+1]);let s=A(e[r+2]);if(i&&s){let e=parseInt(i+s,16);t.push(e);r+=2;continue}}t.push(s)}s=new ArrayBuffer(t.length);let i=new DataView(s);for(let e=0,r=t.length;e<r;e++){i.setUint8(e,t[e])}}else if(t==="B"){s=T(r.replace(/[^a-zA-Z0-9\+\/=]+/g,""))}else{s=y.encode(r)}return w(e).decode(s)}function x(e){return(e||"").toString().replace(/(=\?([^?]+)\?[Bb]\?[^?]*\?=)\s*(?==\?([^?]+)\?[Bb]\?[^?]*\?=)/g,((e,t,r,i)=>{if(r===i){return t+"__\0JOIN\0__"}return e})).replace(/(=\?([^?]+)\?[Qq]\?[^?]*\?=)\s*(?==\?([^?]+)\?[Qq]\?[^?]*\?=)/g,((e,t,r,i)=>{if(r===i){return t+"__\0JOIN\0__"}return e})).replace(/(\?=)?__\x00JOIN\x00__(=\?([^?]+)\?[QqBb]\?)?/g,"").replace(/(=\?[^?]+\?[QqBb]\?[^?]*\?=)\s+(?==\?[^?]+\?[QqBb]\?[^?]*\?=)/g,"$1").replace(/=\?([\w_\-*]+)\?([QqBb])\?([^?]*)\?=/g,((e,t,r,i)=>Y(t,r,i)))}function E(e,t){t=t||"utf-8";let r=[];for(let t=0;t<e.length;t++){let i=e.charAt(t);if(i==="%"&&/^[a-f0-9]{2}/i.test(e.substr(t+1,2))){let i=e.substr(t+1,2);t+=2;r.push(parseInt(i,16))}else if(i.charCodeAt(0)>126){i=y.encode(i);for(let e=0;e<i.length;e++){r.push(i[e])}}else{r.push(i.charCodeAt(0))}}const i=new ArrayBuffer(r.length);const s=new DataView(i);for(let e=0,t=r.length;e<t;e++){s.setUint8(e,r[e])}return w(t).decode(i)}function O(e){let t=new Map;Object.keys(e.params).forEach((r=>{let i=r.match(/\*((\d+)\*?)?$/);if(!i){return}let s=r.substr(0,i.index).toLowerCase();let a=Number(i[2])||0;let n;if(!t.has(s)){n={charset:false,values:[]};t.set(s,n)}else{n=t.get(s)}let o=e.params[r];if(a===0&&i[0].charAt(i[0].length-1)==="*"&&(i=o.match(/^([^']*)'[^']*'(.*)$/))){n.charset=i[1]||"utf-8";o=i[2]}n.values.push({nr:a,value:o});delete e.params[r]}));t.forEach(((t,r)=>{e.params[r]=E(t.values.sort(((e,t)=>e.nr-t.nr)).map((e=>e.value)).join(""),t.charset)}))}class S{constructor(){this.chunks=[]}update(e){this.chunks.push(e);this.chunks.push("\n")}finalize(){return v(new Blob(this.chunks,{type:"application/octet-stream"}))}}class C{constructor(e){e=e||{};this.decoder=e.decoder||new TextDecoder;this.maxChunkSize=100*1024;this.chunks=[];this.remainder=""}update(e){let t=this.decoder.decode(e);if(/[^a-zA-Z0-9+\/]/.test(t)){t=t.replace(/[^a-zA-Z0-9+\/]+/g,"")}this.remainder+=t;if(this.remainder.length>=this.maxChunkSize){let e=Math.floor(this.remainder.length/4)*4;let t;if(e===this.remainder.length){t=this.remainder;this.remainder=""}else{t=this.remainder.substr(0,e);this.remainder=this.remainder.substr(e)}if(t.length){this.chunks.push(T(t))}}}finalize(){if(this.remainder&&!/^=+$/.test(this.remainder)){this.chunks.push(T(this.remainder))}return v(new Blob(this.chunks,{type:"application/octet-stream"}))}}class N{constructor(e){e=e||{};this.decoder=e.decoder||new TextDecoder;this.maxChunkSize=100*1024;this.remainder="";this.chunks=[]}decodeQPBytes(e){let t=new ArrayBuffer(e.length);let r=new DataView(t);for(let t=0,i=e.length;t<i;t++){r.setUint8(t,parseInt(e[t],16))}return t}decodeChunks(e){e=e.replace(/=\r?\n/g,"");let t=e.split(/(?==)/);let r=[];for(let e of t){if(e.charAt(0)!=="="){if(r.length){this.chunks.push(this.decodeQPBytes(r));r=[]}this.chunks.push(e);continue}if(e.length===3){r.push(e.substr(1));continue}if(e.length>3){r.push(e.substr(1,2));this.chunks.push(this.decodeQPBytes(r));r=[];e=e.substr(3);this.chunks.push(e)}}if(r.length){this.chunks.push(this.decodeQPBytes(r));r=[]}}update(e){let t=this.decoder.decode(e)+"\n";t=this.remainder+t;if(t.length<this.maxChunkSize){this.remainder=t;return}this.remainder="";let r=t.match(/=[a-fA-F0-9]?$/);if(r){if(r.index===0){this.remainder=t;return}this.remainder=t.substr(r.index);t=t.substr(0,r.index)}this.decodeChunks(t)}finalize(){if(this.remainder.length){this.decodeChunks(this.remainder);this.remainder=""}return v(new Blob(this.chunks,{type:"application/octet-stream"}))}}class k{constructor(){this.root=this.currentNode=new e({postalMime:this});this.boundaries=[];this.textContent={};this.attachments=[];this.started=false}async finalize(){await this.root.finalize()}async processLine(t,r){let i=this.boundaries;if(i.length&&t.length>2&&t[0]===45&&t[1]===45){for(let s=i.length-1;s>=0;s--){let a=i[s];if(t.length!==a.value.length+2&&t.length!==a.value.length+4){continue}let n=t.length===a.value.length+4;if(n&&(t[t.length-2]!==45||t[t.length-1]!==45)){continue}let o=true;for(let e=0;e<a.value.length;e++){if(t[e+2]!==a.value[e]){o=false;break}}if(!o){continue}if(n){await a.node.finalize();this.currentNode=a.node.parentNode||this.root}else{await a.node.finalizeChildNodes();this.currentNode=new e({postalMime:this,parentNode:a.node})}if(r){return this.finalize()}return}}this.currentNode.feed(t);if(r){return this.finalize()}}readLine(){let e=this.readPos;let t=this.readPos;let r=()=>({bytes:new Uint8Array(this.buf,e,t-e),done:this.readPos>=this.av.length});while(this.readPos<this.av.length){const e=this.av[this.readPos++];if(e!==13&&e!==10){t=this.readPos}if(e===10){return r()}}return r()}async processNodeTree(){let e={};let t=new Set;let r=this.textMap=new Map;let i=async(e,s,a)=>{s=s||false;a=a||false;if(!e.contentType.multipart){if(e.contentType.parsed.value==="message/rfc822"&&e.contentDisposition.parsed.value!=="attachment"){const i=new k;e.subMessage=await i.parse(e.content);if(!r.has(e)){r.set(e,{})}let s=r.get(e);if(e.subMessage.text||!e.subMessage.html){s.plain=s.plain||[];s.plain.push({type:"subMessage",value:e.subMessage});t.add("plain")}if(e.subMessage.html){s.html=s.html||[];s.html.push({type:"subMessage",value:e.subMessage});t.add("html")}if(i.textMap){i.textMap.forEach(((e,t)=>{r.set(t,e)}))}for(let t of e.subMessage.attachments||[]){this.attachments.push(t)}}else if((/^text\//i.test(e.contentType.parsed.value)||e.contentType.parsed.value==="message/delivery-status")&&e.contentDisposition.parsed.value!=="attachment"){let i=e.contentType.parsed.value.substr(e.contentType.parsed.value.indexOf("/")+1);if(e.contentType.parsed.value==="message/delivery-status"){i="plain"}let a=s||e;if(!r.has(a)){r.set(a,{})}let n=r.get(a);n[i]=n[i]||[];n[i].push({type:"text",value:e.getTextContent()});t.add(i)}else if(e.content){let t=e.contentDisposition.parsed.params.filename||e.contentType.parsed.params.name||null;let r={filename:x(t),mimeType:e.contentType.parsed.value,disposition:e.contentDisposition.parsed.value||null};if(a&&e.contentId){r.related=true}if(e.contentId){r.contentId=e.contentId}r.content=e.content;this.attachments.push(r)}}else if(e.contentType.multipart==="alternative"){s=e}else if(e.contentType.multipart==="related"){a=e}for(let t of e.childNodes){await i(t,s,a)}};await i(this.root,false,[]);r.forEach((r=>{t.forEach((t=>{if(!e[t]){e[t]=[]}if(r[t]){r[t].forEach((r=>{switch(r.type){case"text":e[t].push(r.value);break;case"subMessage":{switch(t){case"html":e[t].push(d(r.value));break;case"plain":e[t].push(h(r.value));break}}break}}))}else{let i;switch(t){case"html":i="plain";break;case"plain":i="html";break}(r[i]||[]).forEach((r=>{switch(r.type){case"text":switch(t){case"html":e[t].push(s(r.value));break;case"plain":e[t].push(a(r.value));break}break;case"subMessage":{switch(t){case"html":e[t].push(d(r.value));break;case"plain":e[t].push(h(r.value));break}}break}}))}}))}));Object.keys(e).forEach((t=>{e[t]=e[t].join("\n")}));this.textContent=e}async parse(e){if(this.started){throw new Error("Can not reuse parser, create a new PostalMime object")}this.started=true;e=e||ArrayBuffer(0);if(typeof e==="string"){e=y.encode(e)}if(e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"){e=await v(e)}if(e.buffer instanceof ArrayBuffer){e=new Uint8Array(e).buffer}this.buf=e;this.av=new Uint8Array(e);this.readPos=0;while(this.readPos<this.av.length){const e=this.readLine();await this.processLine(e.bytes,e.done)}await this.processNodeTree();let t={headers:this.root.headers.map((e=>({key:e.key,value:e.value}))).reverse()};for(let e of["from","sender","reply-to"]){let r=this.root.headers.find((t=>t.key===e));if(r&&r.value){let i=m(r.value);if(i&&i.length){t[e.replace(/\-(.)/g,((e,t)=>t.toUpperCase()))]=i[0]}}}for(let e of["delivered-to","return-path"]){let r=this.root.headers.find((t=>t.key===e));if(r&&r.value){let i=m(r.value);if(i&&i.length&&i[0].address){t[e.replace(/\-(.)/g,((e,t)=>t.toUpperCase()))]=i[0].address}}}for(let e of["to","cc","bcc"]){let r=this.root.headers.filter((t=>t.key===e));let i=[];r.filter((e=>e&&e.value)).map((e=>m(e.value))).forEach((e=>i=i.concat(e||[])));if(i&&i.length){t[e]=i}}for(let e of["subject","message-id","in-reply-to","references"]){let r=this.root.headers.find((t=>t.key===e));if(r&&r.value){t[e.replace(/\-(.)/g,((e,t)=>t.toUpperCase()))]=x(r.value)}}let r=this.root.headers.find((e=>e.key==="date"));if(r){let e=new Date(r.value);if(!e||e.toString()==="Invalid Date"){e=r.value}else{e=e.toISOString()}t.date=e}if(this.textContent&&this.textContent.html){t.html=this.textContent.html}if(this.textContent&&this.textContent.plain){t.text=this.textContent.plain}t.attachments=this.attachments;return t}}return k})();module.exports={ICAL:Yt,PostalMime:PostalMime};